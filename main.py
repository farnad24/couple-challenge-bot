import logging
import sqlite3
import random
import asyncio
import time
from aiogram import Bot, Dispatcher, types
from aiogram.filters import Command
from aiogram.types import ReplyKeyboardMarkup, KeyboardButton, InlineKeyboardMarkup, InlineKeyboardButton
import string

# ๐ ุชูุธูุงุช ุงุตู
TOKEN = "Robot Token"
ADMIN_ID = 227975536  # ุขุฏ ุนุฏุฏ ูุฏุฑ
REQUIRED_CHANNEL = "@your_channel"  # ุขุฏ ฺฉุงูุงู ุงุฌุจุงุฑ (ูุซุงู: @your_channel)
CHANNEL_TITLE = "ฺฉุงูุงู ุฑุณู"  # ุนููุงู ฺฉุงูุงู ุจุฑุง ููุงุด ุจู ฺฉุงุฑุจุฑ
SUPPORT_CHAT_ID = ADMIN_ID  # ุขุฏ ฺุช ูพุดุชุจุงู (ูุนูุง ููุงู ุงุฏูู)
# ุฑุงูโุงูุฏุงุฒ ุฑุจุงุช
logging.basicConfig(level=logging.INFO)
bot = Bot(token=TOKEN)
dp = Dispatcher()

# ุงุชุตุงู ุจู ุฏุชุงุจุณ SQLite
conn = sqlite3.connect("partners.db")
cursor = conn.cursor()

# ุงุฌุงุฏ ุฌุฏููโูุง ููุฑุฏูุงุฒ
cursor.execute('''CREATE TABLE IF NOT EXISTS users (
    user_id INTEGER PRIMARY KEY,
    username TEXT,
    first_name TEXT,
    last_name TEXT,
    unique_code TEXT UNIQUE,
    partner_id INTEGER DEFAULT NULL,
    waiting_for_code INTEGER DEFAULT 0,
    last_question_time INTEGER DEFAULT 0,
    waiting_for_support TEXT DEFAULT NULL
)''')

cursor.execute('''CREATE TABLE IF NOT EXISTS questions (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    user_id INTEGER,
    partner_id INTEGER,
    question TEXT,
    answer TEXT DEFAULT NULL,
    timestamp INTEGER DEFAULT NULL
)''')

cursor.execute('''CREATE TABLE IF NOT EXISTS messages (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    sender_id INTEGER,
    receiver_id INTEGER,
    message TEXT DEFAULT NULL,
    media_type TEXT DEFAULT NULL,
    media_id TEXT DEFAULT NULL
)''')

# ุจุฑุฑุณ ูุฌูุฏ ุณุชูู timestamp ุฏุฑ ุฌุฏูู questions
cursor.execute("PRAGMA table_info(questions)")
columns = [column[1] for column in cursor.fetchall()]

# ุงฺฏุฑ ุณุชูู timestamp ูุฌูุฏ ูุฏุงุดุชุ ุขู ุฑุง ุงุถุงูู ฺฉู
if "timestamp" not in columns:
    cursor.execute("ALTER TABLE questions ADD COLUMN timestamp INTEGER DEFAULT NULL")
    
    # ุจูโุฑูุฒุฑุณุงู ุฑฺฉูุฑุฏูุง ููุฌูุฏ ุจุง ุฒูุงู ูุนู
    current_time = int(time.time())
    cursor.execute("UPDATE questions SET timestamp = ? WHERE timestamp IS NULL", (current_time,))
    conn.commit()

conn.commit()

# ูุณุช ุณูุงูุงุช ฺุงูุด ุจุฑุง ุฒูุฌโูุง
questions = [
    # ุณูุงูุงุช ููุฌูุฏ
    "ุณู ฺุฒ ฺฉู ุฏูุณุช ุฏุงุฑ ูุจู ุงุฒ ูุฑฺฏุช ุงูุฌุงู ุจุฏ ฺูุ",
    "ุงฺฏุฑ ูพูู ูุดฺฉู ูุจูุฏุ ฺฉุฌุง ุฒูุฏฺฏ ูโฺฉุฑุฏุ",
    "ุงฺฏู ูโุชููุณุช ูุฑ ฺุฒ ุฑู ุฏุฑ ุฏูุง ุชุบุฑ ุจุฏุ ฺ ุฑู ุงูุชุฎุงุจ ูโฺฉุฑุฏุ",
    "ุงฺฏู ูโุชููุณุช ุจุง ู ุดุฎุตุช ูุดููุฑ ุดุงู ุจุฑุ ฺฉ ุฑู ุงูุชุฎุงุจ ูโฺฉุฑุฏุ",
    "ุงฺฏู ูุฑุงุฑ ุจูุฏ ููุท ฺฉ ูุณูู ุฑู ุจู ู ุฌุฒุฑู ูุชุฑูฺฉ ุจุจุฑุ ฺ ุงูุชุฎุงุจ ูโฺฉุฑุฏุ",
    "ุฌุณูุฑุงููโุชุฑู ฺฉุงุฑ ฺฉู ุชุง ุญุงูุง ุงูุฌุงู ุฏุงุฏ ฺ ุจูุฏูุ",
    "ุจูุชุฑู ุฑูุฒ ุฒูุฏฺฏุช ฺุทูุฑ ูโฺฏุฐุดุชุ",
    "ุงฺฏู ูโุชููุณุช ุจุง ูุฑ ฺฉุณ ููุงูุงุช ฺฉูุ ฺฉ ุฑู ุงูุชุฎุงุจ ูโฺฉุฑุฏุ",
    "ุงฺฏู ู ููุงุฑุฏ ุชููู ุจูุช ุจุฏูุ ุจุง ุงููู ุตุฏ ููููุด ฺฺฉุงุฑ ูโฺฉูุ",
    "ุฎุทุฑูุงฺฉโุชุฑู ฺฉุงุฑ ฺฉู ุญุงุถุฑ ุงูุฌุงู ุจุฏ ฺูุ",
    "ุนููโุชุฑู ุชุฑุณ ฺฉู ุฏุงุฑ ฺู ู ฺุฑุงุ",
    "ฺู ุงุญุณุงุณ ุฑู ุณุฎุชโุชุฑ ุงุฒ ููู ูโุชูู ุงุจุฑุงุฒ ฺฉูุ",
    "ฺู ฺุฒ ุจุงุนุซ ูุดู ฺฉู ุงุญุณุงุณ ฺฉู ุฏูุณุช ุฏุงุดุชู ููุดุ",
    "ุงุฒ ฺู ฺุฒ ุจุดุชุฑ ุงุฒ ููู ุฎุฌุงูุช ูโฺฉุดุ",
    "ฺู ฺุฒ ุจุงุนุซ ูุดู ูุณุจุช ุจู ูพุงุฑุชูุฑุช ุงุญุณุงุณ ูุงุงูู ฺฉูุ",
    "ฺู ูููุนโูุง ุงุญุณุงุณ ูโฺฉู ูุงูุนุงู ุฒูุฏูโุงุ",
    "ฺุฒ ูุณุช ฺฉู ุฏูุณุช ุฏุงุดุชู ุจุงุด ุจุดุชุฑ ุงุฒ ูพุงุฑุชูุฑุช ุจุดููุ",
    "ุงฺฏู ฺฉ ุงุฒ ุดูุง ูุฌุจูุฑ ุจุดู ุงุฒ ุดูุฑ ุฏฺฏูโุง ฺฉุงุฑ ฺฉููุ ฺุทูุฑ ุฑุงุจุทูโุชูู ุฑู ูุฏุฑุช ูโฺฉูุฏุ",
    "ุจุฏุชุฑู ุฏุฑูุบ ฺฉู ุชุง ุญุงูุง ุจู ฺฉุณ ฺฏูุช ฺ ุจูุฏูุ",
    "ฺู ฺฉุชุงุจ ุฎููุฏ ฺฉู ุฒูุฏฺฏุช ุฑู ุชุบุฑ ุฏุงุฏูุ",
    "ฺู ฺุฒูุง ุฏูุณุช ุฏุงุฑ ุชู ุฒูุฏฺฏุช ุจุดุชุฑ ุฏุงุดุชู ุจุงุดุ",
    "ูุณุฆููุช ูุงู ุฎููู ุจู ูุธุฑุช ุจุงุฏ ุจุง ฺฉ ุจุงุดูุ",
    "ุจุฒุฑฺฏุชุฑู ุฒุฎู ุฑูุญโุง ฺฉู ุฏุงุฑ ฺูุ",
    "ฺฏุฑูุชุฑู ุขุบูุด ุฑู ุงุฒ ฺู ฺฉุณ ุฏุฑุงูุช ฺฉุฑุฏุ",
    "ฺู ููุงุฑุชโูุง ุฏูุณุช ุฏุงุฑ ุจู ุจฺูโูุงุช ุงุฏ ุจุฏุ",
    "ุฏุฑ ฺฉ ฺฉูููุ ุนุดู ุจุฑุงุช ฺู ูุนูุง ุฏุงุฑูุ",
    "ฺุฒูุง ฺฉู ุชู ุฑุงุจุทู ุขุฒุงุฑุช ูุฏู ุฑู ูุนูููุงู ูฺฏ ุง ูฺฏู ูุฏุงุฑุ",
    "ฺู ฺฉุณ ุจุดุชุฑู ุชุงุซุฑ ุฑู ุฑู ุดุฎุตุชุช ฺฏุฐุงุดุชูุ",
    "ุฏูุณุช ุฏุงุฑ ูพุงุฑุชูุฑุช ฺุทูุฑ ุงุจุฑุงุฒ ุนุดู ู ุนูุงูู ฺฉููุ",
    
    # ุณูุงูุงุช ุนููู ุฑุงุจุทู
    "ุงฺฏุฑ ฺฉ ุขุฑุฒู ุบุฑููฺฉู ุฏุงุดุชุ ฺ ุจูุฏุ",
    "ุจุฒุฑฺฏุชุฑู ุชุฑุณ ุฒูุฏฺฏุช ฺูุ",
    "ุจูุชุฑู ุฎุงุทุฑูโุง ฺฉู ุจุง ูพุงุฑุชูุฑุช ุฏุงุฑ ฺูุ",
    "ุงฺฏุฑ ูโุชููุณุช ฺฉ ฺุฒ ุฑู ุฏุฑ ุฒูุฏฺฏุช ุชุบุฑ ุจุฏุ ฺ ุจูุฏุ",
    "ฺู ฺุฒ ุฏุฑ ุฑุงุจุทูโููู ุจุดุชุฑ ุงุฒ ููู ุชู ุฑู ุฎูุดุญุงู ูโฺฉููุ",
    "ุจุฒุฑฺฏุชุฑู ุขุฑุฒูุช ุจุฑุง ุขูุฏูโููู ฺูุ",
    "ุงููู ุจุงุฑ ฺฉู ูููุฏ ุนุงุดู ูพุงุฑุชูุฑุช ุดุฏุ ฺฉ ุจูุฏุ",
    "ุชุง ุญุงูุง ูฺฉุฑ ฺฉุฑุฏ ุฑุงุจุทูโุชูู ุจู ูพุงุงู ุจุฑุณูุ ฺุฑุงุ",
    "ุงฺฏู ฺฉ ุฑูุฒ ุงุฒ ุฑุงุจุทูโุชูู ูููุฏู ุจูุฏุ ฺุทูุฑ ูโฺฏุฐุฑููุฏุดุ",
    "ุจุฒุฑฺฏุชุฑู ุฏุนูุง ฺฉู ุจุง ูู ุฏุงุดุชุฏ ฺ ุจูุฏุ",
    "ุงฺฏู ุจุชูู ฺฉ ุงุฒ ุตูุงุช ููู ูพุงุฑุชูุฑุช ุฑู ุชุบุฑ ุจุฏุ ฺฉุฏูู ุฑู ุงูุชุฎุงุจ ูโฺฉูุ",
    "ุงููู ฺุฒ ฺฉู ุฏุฑ ููุฑุฏ ูพุงุฑุชูุฑุช ุชูุฌูุช ุฑู ุฌูุจ ฺฉุฑุฏ ฺ ุจูุฏุ",
    "ุชุง ุญุงูุง ุจู ูพุงุฑุชูุฑุช ุฏุฑูุบ ฺฏูุชุ ุฏุฑ ฺู ููุฑุฏุ",
    "ุชู ุขูุฏู ุฏูุณุช ุฏุงุฑ ฺูุฏ ุชุง ุจฺู ุฏุงุดุชู ุจุงุดุ",
    "ุงฺฏู ูพุงุฑุชูุฑุช ุจุฎูุงุฏ ุจู ุดูุฑ ุฏฺฏูโุง ููู ูฺฉุงู ฺฉููุ ฺฺฉุงุฑ ูโฺฉูุ",
    "ฺฉุฏูู ุนุงุฏุช ูพุงุฑุชูุฑุช ุจุดุชุฑ ุงุฐุชุช ูโฺฉููุ",
    "ฺุฒ ูุณุช ฺฉู ุฏูุณุช ุฏุงุฑ ุจู ูพุงุฑุชูุฑุช ุจฺฏ ูู ูููุฒ ูฺฏูุชุ",
    "ุชุง ุญุงูุง ูพุงุฑุชูุฑุช ุฑู ุฏูุณุช ูุฏุงุดุชุ ฺู ุฒูุงูุ",
    "ุจุดุชุฑู ูุฏุช ุฒูุงู ููุฑุช ุจุง ูพุงุฑุชูุฑุช ฺูุฏุฑ ุจูุฏูุ",
    "ุงฺฏู ุงุฒุช ุฎูุงุณุชฺฏุงุฑ ุจุดูุ ฺุทูุฑ ุฏูุณุช ุฏุงุฑ ุจุงุดูุ",
    "ุงฺฏู ูพุงุฑุชูุฑุช ุจู ฺฉ ุณูุฑ ุทููุงู ฺฉุงุฑ ุจุฑูุ ฺูุฏุฑ ุฏูุชูฺฏุด ูุดุ",
    "ุงฺฏู ุงูุฑูุฒ ุขุฎุฑู ุฑูุฒ ุฒูุฏฺฏุช ุจูุฏุ ุขุฎุฑู ุญุฑูุช ุจู ูพุงุฑุชูุฑุช ฺ ุจูุฏุ",
    "ฺูุฏุฑ ุญุงุถุฑ ุจุฑุง ุฎูุดุญุงู ูพุงุฑุชูุฑุช ุงุฒ ุฎูุฏุช ุจฺฏุฐุฑุ",
    "ฺู ฺุฒ ุจุงุนุซ ูุดู ุชู ุงู ุฑุงุจุทู ุงุญุณุงุณ ุงููุช ฺฉูุ",
    "ฺฉ ู ฺฉุฌุง ุจูุชุฑู ูุญุธุงุช ุฑุงุจุทูโุชูู ุฑู ุชุฌุฑุจู ฺฉุฑุฏุฏุ",
    "ฺู ฺุฒ ุชู ุฑุงุจุทูโุชูู ูุณุช ฺฉู ุงุฒ ุญุฑู ุฒุฏู ุฏุฑ ููุฑุฏุด ุทูุฑู ูุฑุ",
    
    # ุณูุงูุงุช ุฌูุณ ู ุตููุงูู (ุตุฑุญโุชุฑ)
    "ุจูุชุฑู ุณฺฉุณ ุฒูุฏฺฏุช ฺฉ ู ฺฉุฌุง ุจูุฏุ",
    "ุงฺฏุฑ ุจุฎูุง ฺฉ ูุงูุชุฒ ุฌูุณ ุฑู ุจุง ูพุงุฑุชูุฑุช ุชุฌุฑุจู ฺฉูุ ฺ ูุณุชุ",
    "ุฏูุณุช ุฏุงุฑ ุฑุงุจุทู ุฌูุณ ุจุนุฏุชูู ฺฉุฌุง ุจุงุดูุ",
    "ุฏูุณุช ุฏุงุฑ ูพุงุฑุชูุฑุช ุฏุฑ ุฑุงุจุทู ุฌูุณ ุฎุดู ุจุงุดู ุง ููุงูุ",
    "ุขุง ุชุง ุญุงูุง ุจู ูฺฉุฑ ุฑุงุจุทู ุณู ููุฑู ุงูุชุงุฏุ ูุธุฑุช ฺูุ",
    "ุฏูุณุช ุฏุงุฑ ูพุงุฑุชูุฑุช ูููุน ุฑุงุจุทู ฺู ุญุฑูโูุง ุจูุช ุจุฒููุ",
    "ุจู ูพุงุฑุชูุฑุช ุงุนุชุฑุงู ฺฉู ฺฉู ฺู ฺุฒ ุฏุฑ ุจุฏูุด ุจุดุชุฑ ุงุฒ ููู ุชุญุฑฺฉุช ูฺฉููุ",
    "ุฏูุณุช ุฏุงุฑ ูพุงุฑุชูุฑุช ูููุน ุฑุงุจุทู ุฌูุณ ฺู ูุจุงุณ ุจูพูุดูุ",
    "ุฌุฐุงุจโุชุฑู ุฎุงุทุฑู ุฌูุณ ฺฉู ุจุง ูพุงุฑุชูุฑุช ุฏุงุดุช ฺ ุจูุฏูุ",
    "ุงฺฏุฑ ฒด ุณุงุนุช ูุฑ ฺฉุงุฑ ูุชููุณุช ุจุง ุจุฏู ูพุงุฑุชูุฑุช ุจฺฉูุ ฺฺฉุงุฑ ูฺฉุฑุฏุ",
    "ุฑุงุจุทู ุฏูุงู ุจุฑุงุช ููููุ ฺูุฏุฑุ",
    "ุชุง ุญุงูุง ุจู ุฑุงุจุทู ุฌูุณ ุจุง ูุฑุฏ ุบุฑ ุงุฒ ูพุงุฑุชูุฑุช ูฺฉุฑ ฺฉุฑุฏุ",
    "ุจูุชุฑู ุงุฑฺฏุงุณู ฺฉู ุชุฌุฑุจู ฺฉุฑุฏ ฺุทูุฑ ุจูุฏุ",
    "ูููุน ุฎูุฏุงุฑุถุง ุจู ฺ ูฺฉุฑ ูฺฉูุ",
    "ุชูุงู ุจู ุงุณุชูุงุฏู ุงุฒ ุงุณุจุงุจโุจุงุฒ ุฌูุณ ุฏุงุฑุ",
    "ูุฑ ฺูุฏ ููุช ฺฉุจุงุฑ ูุงุฒ ุฌูุณ ุฏุงุฑุ",
    "ุฏูุณุช ุฏุงุฑ ูพุงุฑุชูุฑุช ฺู ูุฏู ูููุง ุฒูุงุฑ ุฏุงุดุชู ุจุงุดูุ",
    "ุบุฑ ุงุฒ ุงูุฏุงู ุชูุงุณูุ ฺฉุฏูู ูุณูุช ุจุฏูุช ุญุณุงุณโุชุฑู ููุทู ุจุฑุง ุชุญุฑฺฉ ุดุฏููุ",
    "ุงฺฏุฑ ูพุงุฑุชูุฑุช ุจุฎูุงุฏ ู ุนฺฉุณ ุณฺฉุณ ุงุฒุช ุฏุงุดุชู ุจุงุดูุ ูุจูู ูฺฉูุ",
    "ุณฺฉุณ ุชุญุช ุชุงุซุฑ ุงูฺฉู ุง ููุงุฏ ูุฎุฏุฑ ุฑู ุงูุชุญุงู ฺฉุฑุฏุ ูุธุฑุช ฺูุ",
    "ุฏูุณุช ุฏุงุฑ ูพุงุฑุชูุฑุช ุฑู ฺฉุฏูู ูุณูุช ุจุฏูุช ุจุดุชุฑ ุชูุฑฺฉุฒ ฺฉููุ",
    "ุงููู ุชุฌุฑุจู ุฌูุณโุงุช ฺุทูุฑ ุจูุฏุ",
    "ุจู ูุธุฑุช ูููโุชุฑู ฺุฒ ุฏุฑ ุฑุงุจุทู ุฌูุณ ฺูุ",
    "ุงฺฏุฑ ูุฑุงุฑ ุจุงุดู ฺฉ ูพูุฒุดู ุฌุฏุฏ ุจุง ูพุงุฑุชูุฑุช ุงูุชุญุงู ฺฉูุ ฺ ูุณุชุ",
    "ุงุฒ ูุจู ุจุฑุง ุฑุงุจุทู ุฌูุณ ุจุฑูุงููโุฑุฒ ูฺฉู ุง ุชุฑุฌุญ ูุฏ ุฎูุฏุจูโุฎูุฏ ุงุชูุงู ุจูุชูุ",
    "ฺฉุณ ูุณุช ฺฉู ุจุฎูุง ูพุงุฑุชูุฑุช ูุฏููู ุจูุด ุฌุฐุจ ุฌูุณ ุฏุงุฑุ",
    "ุจุฒุฑฺฏุชุฑู ุขุฑุฒู ุฌูุณโุงุช ฺูุ",
    "ุชุง ุญุงูุง ุฎูุงุจ ุฌูุณ ุฏุฏ ฺฉู ุจุนุฏ ุงุฒ ุจุฏุงุฑ ุดุฏู ุฎุฌุงูุช ฺฉุดุฏู ุจุงุดุ",
    "ู ูุงูุชุฒ ุฌูุณ ุฎุงุต ุฏุงุฑ ฺฉู ุชุง ุญุงูุง ุจู ฺฉุณ ูฺฏูุชู ุจุงุดุ",
    "ุขุง ุจู ุฑุงุจุทู ุจุงุฒ (ุฏุงุดุชู ุฑุงุจุทู ุจุง ุงูุฑุงุฏ ุฏฺฏุฑ ุจุง ุชูุงูู ุทุฑูู) ูฺฉุฑ ฺฉุฑุฏุ",
    "ฺูุฏ ุณุงูุช ุจูุฏ ฺฉู ุงููู ุจุงุฑ ุงูฺฏุฒุด ุฌูุณ ุฑู ุชุฌุฑุจู ฺฉุฑุฏุ",
    "ุชุง ุญุงูุง ุฑุงุจุทู ุฌูุณ ุชู ูฺฉุงู ุนููู ุฏุงุดุชุ ุง ุฏูุณุช ุฏุงุฑ ุงูุชุญุงู ฺฉูุ",
    "ุงฺฏู ูพุงุฑุชูุฑุช ุจุฎูุงุฏ ู ุฑุงุจุทู ููุนุฏ ุฏุงุดุชู ุจุงุดูุ ูุจูู ูโฺฉูุ",
    "ุฌุฐุงุจโุชุฑู ฺุฒ ุฏุฑ ุฑุงุจุทู ุฌูุณ ุจุฑุงุช ฺูุ",
    "ุชู ุฑุงุจุทู ุฌูุณ ุชุฑุฌุญ ูุฏ ุชุณูู ุจุงุด ุง ูุณูุทุ",
    "ุฏูุณุช ุฏุงุฑ ูพุงุฑุชูุฑุช ูุจู ุงุฒ ุฑุงุจุทู ฺู ฺฉุงุฑ ุงูุฌุงู ุจุฏูุ",
    "ุฎุงุตโุชุฑู ูฺฉุงู ฺฉู ุฏูุณุช ุฏุงุฑ ุฑุงุจุทู ุฌูุณ ุฏุงุดุชู ุจุงุด ฺฉุฌุงุณุชุ",
    "ฺุฒ ูุณุช ฺฉู ุชู ุฑุงุจุทู ุฌูุณ ุญุงุถุฑ ูุจุงุด ุงูุฌุงู ุจุฏุ",
    "ุฏูุณุช ุฏุงุฑ ุฑุงุจุทู ุฌูุณ ฺูุฏุฑ ุทูู ุจฺฉุดูุ",
    "ฺู ฺฉููุงุช ุง ุฌููุงุช ุฏูุณุช ุฏุงุฑ ูููุน ุฑุงุจุทู ุงุฒ ูพุงุฑุชูุฑุช ุจุดููุ",
    "ุชุง ุญุงูุง ุชู ุฑุงุจุทู ุฌูุณ ุจู ฺุฒ ูุงูููุฏ ฺฉุฑุฏ ฺฉู ูุงูุนุช ูุฏุงุดุชูุ",
    "ฺูุฏุฑ ุจุฑุงุช ูููู ฺฉู ูพุงุฑุชูุฑุช ุงุฒ ูุธุฑ ุฌูุณ ููุท ุจุง ุชู ุจุงุดูุ",
    "ฺุฒ ูุณุช ฺฉู ูพุงุฑุชูุฑุช ุชู ุฑุงุจุทู ุฌูุณ ุงูุฌุงู ุจุฏู ู ุฎู ุฏูุณุชุด ุฏุงุดุชู ุจุงุดุ",
    "ฺุฒ ูุณุช ฺฉู ูพุงุฑุชูุฑุช ุชู ุฑุงุจุทู ุฌูุณ ุงูุฌุงู ุจุฏู ู ุงุตูุง ุฎูุดุช ูุงุฏุ",
    "ุฏูุณุช ุฏุงุฑ ูพุงุฑุชูุฑุช ูููุงุช ุฑู ุจฺฉุดูุ",
    "ุขุง ุฏูุณุช ุฏุงุฑ ูพุงุฑุชูุฑุช ุฑูุช ุงุณูพูฺฉ ุจุฒููุ",
    "ุฏูุณุช ุฏุงุฑ ูููุน ุฑุงุจุทู ุฌูุณ ุงุฒ ุขูู ุงุณุชูุงุฏู ฺฉู ู ุฎูุฏุชูู ุฑู ุจุจูุ",
    "ุชุง ุญุงูุง ุจู ูฺฉุฑ ููู ฺฏุฑูุชู ุงุฒ ุฑุงุจุทู ุฌูุณโุชูู ุงูุชุงุฏุ",
    "ุฏูุณุช ุฏุงุฑ ุฑุงุจุทู ุฏูุงู ุฑู ุฏุฑุงูุช ฺฉู ุง ุงูุฌุงู ุจุฏุ",
    "ุฏูุณุช ุฏุงุฑ ูพุงุฑุชูุฑุช ฺู ุนุทุฑ ุจุฒูู ฺฉู ุชุญุฑฺฉุช ฺฉููุ",
    "ฺู ูุจุงุณ ุฒุฑ ุฏูุณุช ุฏุงุฑ ูพุงุฑุชูุฑุช ุจูพูุดูุ",
    "ุจุฏู ูพุงุฑุชูุฑุช ุฑู ุจุง ฺู ฺุฒ ุฏูุณุช ุฏุงุฑ ุชุฒู ฺฉูุ (ุดฺฉูุงุชุ ุฎุงููุ ู...)",
    "ุฏูุณุช ุฏุงุฑ ฺุดูุงุช ุจุณุชู ุจุงุดู ุง ูพุงุฑุชูุฑุช ุฑู ุจุจูุ",
    "ุงฺฏู ูพุงุฑุชูุฑุช ุจุฎูุงุฏ ฺฉ ููุดโุจุงุฒ ุฌูุณ ุงูุฌุงู ุจุฏูุ ฺู ููุด ุฏูุณุช ุฏุงุฑ ุจุงุฒ ฺฉููุ",
    "ุฏูุณุช ุฏุงุฑ ุงุฒ ูุณุงู ุจุงูุฏุงฺ ุงุณุชูุงุฏู ฺฉูุ",
    "ุงฺฏู ุงุฌุงุฒู ุฏุงุดุชู ุจุงุด ููุท ฺฉ ูุณูุช ุงุฒ ุจุฏู ูพุงุฑุชูุฑุช ุฑู ููุณ ฺฉูุ ฺฉุฏูู ูุณูุช ุฑู ุงูุชุฎุงุจ ูโฺฉูุ",
    "ุจุดุชุฑ ุชุฑุฌุญ ูุฏ ุฒูุฏ ุงุฑุถุง ุจุด ุง ุฑุงุจุทู ุทููุงูโูุฏุช ุฏุงุดุชู ุจุงุดุ",
    "ุงฺฏู ููุท ฺฉ ูพูุฒุดู ูโุชููุณุช ุชุง ุขุฎุฑ ุนูุฑ ุฏุงุดุชู ุจุงุดุ ฺฉุฏูู ุฑู ุงูุชุฎุงุจ ูโฺฉุฑุฏุ",
    "ุฏูุณุช ุฏุงุฑ ุชู ฺู ุดุฑุงุท ุงุฑุถุง ุจุดุ",
    "ฺู ูุงูุชุฒโุง ุฏุงุฑ ฺฉู ุฎุฌุงูุช ูโฺฉุด ุจู ูพุงุฑุชูุฑุช ุจฺฏุ",
    "ุฏูุณุช ุฏุงุฑ ุฑุงุจุทู ุฌูุณโุชูู ฺูุฏุฑ ุตุฏุง ุฏุงุดุชู ุจุงุดูุ",
    "ุฏูุณุช ุฏุงุฑ ุชู ุญูุงู ุง ูุงู ุฑุงุจุทู ุฏุงุดุชู ุจุงุดุ",
    "ุงุฒ ุงูฺฉู ูพุงุฑุชูุฑุช ุจุฏู ุจุฑูููโุงุช ุฑู ุจุจูู ฺู ุงุญุณุงุณ ุฏุงุฑุ",
    "ุชุง ุญุงูุง ุดุฏู ูููุน ุฑุงุจุทู ุจู ูพุงุฑุชูุฑุช ูฺฉุฑ ูฺฉูุ",
    "ุฎูุฏุงุฑุถุง ุฑู ฺูุฏ ุจุงุฑ ุฏุฑ ููุชู ุงูุฌุงู ูุฏุ",
    "ฺู ฺฉุงุฑ ุบุฑูุนููู ุฏูุณุช ุฏุงุฑ ูพุงุฑุชูุฑุช ุฏุฑ ุฑุงุจุทู ุฌูุณ ุงูุฌุงู ุจุฏูุ",
    "ุฏูุณุช ุฏุงุฑ ุจุง ูพุงุฑุชูุฑุช ูพูุฑู ุจุจูุ",
    "ุจูุชุฑู ุฒูุงู ุฑูุฒ ุจุฑุง ุฑุงุจุทู ุฌูุณ ุงุฒ ูุธุฑุช ฺู ุฒูุงููุ",
    "ุชุง ุญุงูุง ุจุนุฏ ุงุฒ ุฑุงุจุทู ุฌูุณ ูพุดููู ุดุฏุ",
    "ุจูุชุฑู ูฺฉุงู ุจุฏูุช ุจุฑุง ุจูุณุฏู ฺฉุฌุงุณุชุ",
    "ุจุนุฏ ุงุฒ ุฑุงุจุทู ุฌูุณ ุฏูุณุช ุฏุงุฑ ฺฺฉุงุฑ ฺฉูุ",
    "ุฏูุณุช ุฏุงุฑ ูุจุงุณ ุฎุงุต ูููุน ุฑุงุจุทู ุจูพูุดุ",
    "ุฏูุณุช ุฏุงุฑ ุฑู ฺู ุณุทุญ ุบุฑ ุงุฒ ุชุฎุช ุฑุงุจุทู ุฏุงุดุชู ุจุงุดุ",
    "ุงุฑฺฏุงุณู ูุตููุน ุฏุงุดุช ุง ูุงูููุฏ ฺฉุฑุฏุ",
    "ุงฺฏุฑ ูโุชููุณุช ุขุฑุฒู ฺฉู ูพุงุฑุชูุฑุช ฺฉ ููุงุฑุช ุฌูุณ ุฌุฏุฏ ุงุฏ ุจฺฏุฑูุ ฺ ุฑู ุงูุชุฎุงุจ ูโฺฉุฑุฏุ",
    
    # ุณูุงูุงุช ูุชูุฑูู
    "ุจูุณู ุง ุขุบูุดุ",
    "ุฏูุณุช ุฏุงุฑ ฺู ูุฏูโุง ุงุฒ ูพุงุฑุชูุฑุช ุจฺฏุฑุ",
    "ุฏูุณุช ุฏุงุฑ ุจุง ููุฏฺฏู ุจู ฺฉุฌุง ุณูุฑ ฺฉููุ",
    "ููุช ุนุตุจุงู ูุณุช ุฏูุณุช ุฏุงุฑ ุชููุง ุจุงุด ุง ุฏุฑููุฑุฏุด ุจุง ูู ุญุฑู ุจุฒูุฏุ",
    "ฺุฒ ูุณุช ฺฉู ุฏูุช ุจุฎูุงุฏ ุจู ูพุงุฑุชูุฑุช ุจฺฏ ู ุชุง ุญุงูุง ูฺฏูุชุ",
    "ููู ุฏุฏู ุชู ุฎููู ุง ุณููุงุ",
    "ุงููู ฺุฒ ฺฉู ุงุฒ ูพุงุฑุชูุฑุช ุจู ูุธุฑุช ุฌุฐุงุจ ุงููุฏ ฺ ุจูุฏุ",
    "ูุธุฑุช ุฏุฑููุฑุฏ ุจู ูุฑุฒูุฏ ฺฏุฑูุชู ู ุจฺู ุจโุณุฑูพุฑุณุช ฺูุ",
    "ุงุฒ ูุธุฑ ุชู ูููโุชุฑู ููุงุณุจุช (ุชููุฏุ ุณุงูฺฏุฑุฏ ุงุฒุฏูุงุฌุ ูููุชุงู ู...) ฺูุ",
    "ุจุฒุฑฺฏุชุฑู ููุทู ุถุนู ูพุงุฑุชูุฑุช ุงุฒ ูุธุฑ ุชู ฺูุ",
    "ฺ ุฏุฑ ููุฑุฏ ุจฺฺฏโูุงุช ูุฌูุฏ ุฏุงุฑู ฺฉู ุฏูุช ุจุฎูุงุฏ ุจู ูพุงุฑุชูุฑุช ุจฺฏุ",
    "ุจุง ฺฉ ฺฉููู ูพุงุฑุชูุฑุช ุฑู ุชูุตู ฺฉู",
    "ููฺฉุดู ุง ุฌุง ุฎุงุต ูุณุช ฺฉู ุฏูุณุช ุฏุงุดุชู ุจุงุด ุจู ูพุงุฑุชูุฑุช ูุดูู ุจุฏุ",
    "ุงุฒ ุจู ุฏูุณุชุงู ูพุงุฑุชูุฑุช ุงุฒ ฺู ฺฉุณ ุฎูุดุช ููุงุฏ ู ฺุฑุงุ",
    "ูฺฉุงู ุงุฏูโุขูุช ุจุฑุง ุฒูุฏฺฏ ุจุง ููุฏฺฏู ฺฉุฌุงุณุชุ",
    "ุงฺฏู ูพุงุฑุชูุฑุช ฺู ฺฉุงุฑ ุฑู ุงูุฌุงู ุจุฏู ุงุตูุง ููโุชูู ุจุจุฎุดุดุ",
    "ฺู ูุฏู ูุดุชุฑฺฉ ุจุฑุง ต ุณุงู ุขูุฏู ุชู ุฐููุชู ฺฉู ุฏูุณุช ุฏุงุฑ ุจุง ููุฏฺฏู ุจูุด ุจุฑุณุฏุ",
    "ุจูุชุฑู ูฺฺฏ ูพุงุฑุชูุฑุช ุงุฒ ูุธุฑ ุชู ฺูุ",
    "ุจูุธุฑุช ฑฐ ุณุงู ุฏฺฏู ูุถุนุช ุฑุงุจุทุชูู ุจู ฺู ุตูุฑุชูุ",
    "ุงุฒ ฺู ุฎูุดโฺฏุฐุฑููโูุง ฺฉูฺฺฉ ุจุดุชุฑู ูุฐุช ุฑู ูโุจุฑุ",
    "ฺู ุฒูุงู ุงุญุณุงุณ ูโฺฉู ูุงูุนุง ุฎูุฏุช ูุณุชุ",
    "ุจู ฺู ฺุฒ ุฏุฑ ููุฑุฏ ูพุงุฑุชูุฑุช ุงูุชุฎุงุฑ ูโฺฉูุ",
    "ุขุฎุฑู ุจุงุฑ ฺฉู ฺฏุฑู ฺฉุฑุฏ ฺฉ ุจูุฏูุ",
    "ฺฉุฏูู ุนุงุฏุช ุฑู ุงุฒ ุจฺฺฏ ุชุง ุงูุงู ุฏุงุฑุ",
    "ฺู ุณุฑฺฏุฑู ุง ูุนุงูุชโูุง ูุณุช ฺฉู ุฏูุณุช ุฏุงุฑ ุจุง ููุฏฺฏู ุงูุฌุงู ุจุฏุฏุ",
    "ุจูุธุฑุช ฺุทูุฑ ูโุชูู ูพุงุฑุชูุฑุช ุฑู ุฎูุดุจุฎุช ฺฉูุ",
    "ฺ ุจุงุนุซ ูุดู ุญุณ ูููโุงูุนุงุฏูโุง ุจู ุฎูุฏุช ูพุฏุง ฺฉูุ",
    "ุจูุธุฑุช ุจุฒุฑฺฏุชุฑู ููุทู ููุช ุฑุงุจุทุชูู ฺูุ",
    "ุฏูุณุช ุฏุงุฑ ููุช ุจุงุฒูุดุณุชู ุดุฏุฏุ ฺฉุฌุง ุฒูุฏฺฏ ฺฉูุฏุ",
    "ุจูุธุฑุช ููุช ูพุงุฑุชูุฑุช ูพุฑ ุจุดู ุฑู ุงุนุตุงุจโุชุฑู ุงุฎูุงูุด ฺูุ",
    "ูุธุฑุช ุฏุฑ ููุฑุฏ ุงูฺฉู ฺฏุงู ูพุงุฑุชูุฑุช ุจู ุชููุง ุง ุจุง ุฏูุณุชุงูุด ุจุฑู ุณูุฑ ฺูุ",
    "ุงฺฏู ุจุชูู ู ฺุฒ ุฑู ุฏุฑ ุฑุงุจุทู ุฏูููุฑุชูู ุชุบุฑ ุจุฏ ุงูู ฺูุ",
    "ฺู ฺุฒ ุฑู ุฏุฑ ุฎูุฏุช ุฏูุณุช ูุฏุงุฑ ู ุฏูุช ูุฎูุงุฏ ุชุบุฑุด ุจุฏุ",
    "ุจูุณู ุงุฒ ูพุดูู ุง ฺฏูููุ",
    "ุดุงุฏุชุฑู ูุญุธูโุง ฺฉู ุชุง ุงูุงู ุจุง ูู ุฏุงุดุชุฏ ฺฉ ุจูุฏูุ",
    "ุจุฒุฑฺฏโุชุฑู ฺุงูุด ฺฉู ุจุงูู ุชุง ุงูุงู ุฏุงุดุชุฏ ฺูุ",
    "ููุช ฺฉู ูุงุฑุงุญุช ูพุงุฑุชูุฑุช ฺู ฺฉุงุฑ ุงูุฌุงู ุจุฏู ุญุงูุช ุจูุชุฑ ูุดูุ",
    "ู ุนูุงุฑุช ุจุฒุฑฺฏ ุฎุงุฑุฌ ุงุฒ ุดูุฑ ุง ู ุขูพุงุฑุชูุงู ฺฉูฺฺฉ ุฏุงุฎู ุดูุฑุ",
    "ุจูุณู ุฒุฑ ุจุงุฑูู ุง ูุจ ุฏุฑุงุ",
    "ุจูุธุฑุช ุจุฒุฑฺฏโุชุฑู ููุทู ุถุนู ุฑุงุจุทุชูู ฺูุ",
    "ุจู ฺู ฺุฒ ุฏุฑ ููุฑุฏ ุฎูุฏุช ุงูุชุฎุงุฑ ูโฺฉูุ",
    "ุญุงุถุฑ ุฏุฑ ูฺฉุงูโูุง ุนููู ูู ุฑู ุจุจูุณุฏุ",
    "ุชุฑุฌุญ ูุฏ ฺู ฺฉุงุฑ ุฑู ุจู ุฌุง ูพุงุฑุชูุฑุช ุจุง ุฏูุณุชุงุช ุงูุฌุงู ุจุฏุ",
    "ุนุดูุจุงุฒ ุง ุงุฑฺฏุงุณูุ",
    "ูุธุฑุช ุฏุฑ ููุฑุฏ ูุฑุฏุช ุฏุฑ ุฑุงุจุทู ู ฺฏุงู ุชููุง ุจูุฏู ู ุฏุงุดุชู ุญุฑู ุดุฎุต ุฏุฑ ุนู ุฏุงุดุชู ุชุนูุฏ ฺูุ",
    "ุฏุณุชโูุงุด ุง ฺุดูโูุงุดุ",
    "ุจูุธุฑุช ููุช ูุงุฑุงุญุช ูพุงุฑุชูุฑุช ุจุงุฏ ุฎูุฏุด ุจูููู ุง ุฎูุฏุช ุจุงุฏ ุจูุด ุจฺฏ ฺ ูุงุฑุงุญุชุช ฺฉุฑุฏูุ",
    "ุณู ุชุง ฺุฒ ฺฉู ุฏูุณุช ุฏุงุฑ ุฏุฑ ููุฑุฏ ูพุงุฑุชูุฑุช ุชุบุฑ ุจุฏ ฺูุ",
    "ุจุง ุดูุฏู ฺฉุฏูู ุขููฺฏ ุงุฏ ูพุงุฑุชูุฑุช ููุชุ",
    "ุงุฒ ุงูุฌุงู ฺู ฺฉุงุฑ ุชู ุฒูุฏฺฏุช ูพุดูุงู ูุณุชุ",
    "ฺฉุฏูู ูฺฺฏ ุธุงูุฑ ูพุงุฑุชูุฑุช ุฑู ุฏูุณุช ุฏุงุฑุ",
    "ุงุฒ ฺฉุฏูู ูุจุงุณ ูพุงุฑุชูุฑุช ุจุดุชุฑ ุฎูุดุช ูุงุฏุ",
    "ุจู ุฎููุณุฑุฏ ูพุงุฑุชูุฑุช ุงุฒ ฑ ุชุง ฑฐ ฺฉ ุงูุชุงุฒ ุจุฏู",
    "ุงฺฏู ุจุฑุง ฺฉ ุฑูุฒ ูุงูุฑุฆ ุจูุฏุ ฺฺฉุงุฑ ูโฺฉุฑุฏุ",
    "ุงฺฏู ูโุชููุณุช ู ุงุจุฑูุฏุฑุช ุฏุงุดุชู ุจุงุดุ ฺ ุงูุชุฎุงุจ ูโฺฉุฑุฏุ",
    "ุงฺฏู ุฏูุง ูุฑุฏุง ุชููู ูโุดุฏุ ุขุฎุฑู ฺฉุงุฑ ฺฉู ุจุง ูพุงุฑุชูุฑุช ูโฺฉุฑุฏ ฺ ุจูุฏุ",
    "ุฌุณูุฑุงููโุชุฑู ฺฉุงุฑ ฺฉู ุฏูุณุช ุฏุงุฑ ุจุง ูพุงุฑุชูุฑุช ุงูุฌุงู ุจุฏ ฺูุ",
    "ุฏูุณุช ุฏุงุฑ ฺู ูุงุฌุฑุงุฌู ุฑู ุจุง ูู ุชุฌุฑุจู ฺฉูุฏุ",
    
    # ุณูุงูุงุช ุนููโุชุฑ ุฑุงุจุทู
    "ฺู ูุณุฆููโุง ุฏุฑ ุฑุงุจุทูโููู ูุณุช ฺฉู ุงุฒ ุญุฑู ุฒุฏู ุฏุฑ ููุฑุฏุด ุทูุฑู ูุฑุ",
    "ุฏุฑ ฺฉ ุณุงู ุขูุฏูุ ุฎูุฏุช ุฑู ฺฉุฌุง ูโุจูุ ูุง ุฑู ฺฉุฌุง ูโุจูุ",
    "ุชุง ุญุงูุง ุงุญุณุงุณ ฺฉุฑุฏ ฺฉู ูโุฎูุง ุงุฒ ุงู ุฑุงุจุทู ุจุฑูู ุจุฑุ ฺุฑุงุ",
    "ฺู ฺุฒ ุฏุฑ ุฑุงุจุทูโููู ุจุดุชุฑ ุงุฒ ููู ุชู ุฑู ุขุฒุงุฑ ูุฏูุ",
    "ุงฺฏุฑ ูโุชููุณุช ฺฉ ุงุฒ ุชุฑุณโูุงุช ุฑู ุจุง ูู ุจู ุงุดุชุฑุงฺฉ ุจุฐุงุฑุ ฺ ูฺฏูุชุ",
    "ฺฉุฏูู ุชุตูู ูุดุชุฑฺฉููู ูฺฉุฑ ูโฺฉู ุงุดุชุจุงู ุจูุฏูุ",
    "ฺู ฺุฒ ุฏุฑ ููุฑุฏ ูู ูุณุช ฺฉู ูููุฒ ููโุฏูู ูู ุฏูุณุช ุฏุงุฑ ุจุฏููุ",
    "ุจุฒุฑฺฏุชุฑู ุฏุนูุง ฺฉู ุจุง ูู ุฏุงุดุชู ฺ ุจูุฏุ ฺุทูุฑ ูโุชููุณุชู ุจูุชุฑุด ฺฉููุ",
    "ุชุง ุญุงูุง ุจู ูู ุฏุฑูุบ ฺฏูุชุ ฺุฑุงุ",
    "ฺุฒ ูุณุช ฺฉู ูู ูฺฉุฑ ฺฉูู ุฏูุณุช ุฏุงุฑุ ูู ุฏุฑ ูุงูุน ุงุตูุงู ุฏูุณุช ูุฏุงุดุชู ุจุงุดุ",
    "ุงุฒ ฺู ฺุฒ ุฏุฑ ุฑุงุจุทูโููู ูพุดูููุ",
    "ฺฉุฏูู ุนุงุฏุชโูุงู ุจุดุชุฑ ุงุฒ ููู ุงุฐุชุช ูโฺฉููุ",
    "ฺู ฺุฒ ุจุงุนุซ ูุดู ูฺฉุฑ ฺฉู ฺฉู ูุง ุจุฑุง ูู ููุงุณุจ ูุณุชูุ",
    "ฺุฒ ูุณุช ฺฉู ุฏูุณุช ุฏุงุดุชู ุจุงุด ุฏุฑ ููุฑุฏุด ุจุง ูู ุตุญุจุช ฺฉูุ ูู ูุชููุณุชุ",
    "ุงฺฏุฑ ุงูุฑูุฒ ุขุฎุฑู ุฑูุฒ ุฒูุฏฺฏุช ุจูุฏุ ฺู ุญุฑู ุจู ูู ูโุฒุฏุ",
    "ููุช ุนุตุจุงู ูุดุ ุชุฑุฌุญ ูุฏ ุชููุง ุจุงุด ุง ุจุง ูู ุญุฑู ุจุฒูุ",
    "ุชุง ุญุงูุง ุงุฒ ูู ูุงุงูุฏ ุดุฏุ ฺฉู ู ฺุฑุงุ",
    "ฺุทูุฑ ูโุชููู ุจูุชุฑ ุจุง ูู ุงุฑุชุจุงุท ุจุฑูุฑุงุฑ ฺฉููุ",
    
    # ุณูุงูุงุช ุฏุฑุจุงุฑู ุขูุฏู
    "ุฎูุฏุช ุฑู ุชุง ฑฐ ุณุงู ุขูุฏู ฺฉุฌุง ูโุจูุ",
    "ุฏูุณุช ุฏุงุฑ ฺูุฏ ุชุง ุจฺู ุฏุงุดุชู ุจุงุดุ",
    "ุจู ุงุฒุฏูุงุฌ ุจุง ูู ูฺฉุฑ ูโฺฉูุ",
    "ุฏูุณุช ุฏุงุฑ ฺฉุฌุง ุฒูุฏฺฏ ฺฉููุ",
    "ุงฺฏุฑ ูุฑุงุฑ ุจุงุดู ุจุง ูู ุงุฒุฏูุงุฌ ฺฉููุ ุนุฑูุณ ุงุฏูโุขูุช ฺุทูุฑูุ",
    "ุจุฒุฑฺฏุชุฑู ูุฏูุช ุจุฑุง ต ุณุงู ุขูุฏู ฺูุ",
    "ุชู ุขูุฏูุ ุฏูุณุช ุฏุงุฑ ฺู ุณุจฺฉ ุฒูุฏฺฏโุง ุฏุงุดุชู ุจุงุดูุ",
    "ุงฺฏุฑ ุฑูุฒ ุจุฎูุงู ุจุง ูู ุฒูุฏฺฏ ฺฉููุ ฺฉุฏูู ฺฉ ุงุฒ ุนุงุฏุชโูุงุช ููฺฉูู ููู ุงุฐุช ฺฉููุ",
    "ุงฺฏุฑ ูู ุดุบู ูพุฏุง ฺฉูู ฺฉู ูุฌุจูุฑ ุจุดู ุจู ุดูุฑ ุฏฺฏูโุง ุจุฑูุ ุชู ฺฺฉุงุฑ ูโฺฉูุ",
    "ุจุฒุฑฺฏุชุฑู ุชุฑุณุช ุฏุฑ ููุฑุฏ ุชุดฺฉู ุฎุงููุงุฏู ฺูุ",
    "ุงฺฏุฑ ฺฉ ุงุฒ ูุง ุจูุงุฑ ุจุดูุ ฺุทูุฑ ุจุง ุงู ููุถูุน ฺฉูุงุฑ ูุงุ",
    "ูฺฉุฑ ูโฺฉู ุชู ุขูุฏู ุจุงุฏ ูุณุฆููุช ูุงู ุฎููู ุจุง ฺฉ ุจุงุดูุ",
    "ุงฺฏู ุจฺูโุฏุงุฑ ุจุดูุ ฺู ุงุฑุฒุดโูุง ูโุฎูุง ุจูุดูู ุงุฏ ุจุฏุ",
    "ุชู ุฒูุฏฺฏ ูุดุชุฑฺฉุ ุงูุชุธุงุฑ ุฏุงุฑ ูุธุงู ุฎููู ฺุทูุฑ ุชูุณู ุจุดูุ",
    "ุงฺฏุฑ ูพุฏุฑ ู ูุงุฏุฑุช ูุงุฒ ุจู ูุฑุงูุจุช ุฏุงุดุชู ุจุงุดูุ ุงูุชุธุงุฑ ุฏุงุฑ ฺฺฉุงุฑ ฺฉููุ",
    "ุชูุงู ุฏุงุฑ ฺฉุฏูู ุณูุชโูุง ุฎุงููุงุฏฺฏุช ุฑู ุงุฏุงูู ุจุฏุ",
    "ุจุฒุฑฺฏุชุฑู ูุฏูุช ุจุฑุง ุฑุงุจุทูโููู ฺูุ",
    "ุฏุฑ ููุฑุฏ ูพุณโุงูุฏุงุฒ ู ุฎุฑุฌ ฺฉุฑุฏู ูพูู ฺู ูุธุฑ ุฏุงุฑุ",
    "ุฏูุณุช ุฏุงุฑ ูพุฑ ุดุฏูููู ฺฉูุงุฑ ูู ฺุทูุฑ ุจุงุดูุ",
    "ุงฺฏุฑ ฺฉ ุงุฒ ูุง ูุฑุตุช ุดุบู ุฎูุจ ูพุฏุง ฺฉูู ฺฉู ุจุงุนุซ ุฏูุฑ ูุง ุจุดูุ ุชุตููุช ฺูุ",
    
    # ุณูุงูุงุช ุตููุงูู ู ุฌูุณ
    "ุฏูุณุช ุฏุงุฑ ุจุดุชุฑ ฺู ฺฉุงุฑ ุฑู ุจุง ูู ุฏุฑ ุฑุงุจุทู ุงูุชุญุงู ฺฉููุ",
    "ุฌุฐุงุจโุชุฑู ฺุฒ ุฏุฑ ููุฑุฏ ูู ุงุฒ ูุธุฑ ุฌุณู ฺูุ",
    "ูุงูุชุฒ ุฌูุณ ฺฉู ุฏูุณุช ุฏุงุฑ ุจุง ูู ุชุฌุฑุจู ฺฉู ฺูุ",
    "ฺุฒ ูุณุช ฺฉู ูู ุฏุฑ ุฑุงุจุทู ุฌูุณ ุงูุฌุงู ูุฏู ู ุฎู ุฏูุณุช ุฏุงุฑุ",
    "ุชุง ุญุงูุง ุฏุฑ ุญู ุฑุงุจุทู ุจุง ูู ุจู ฺฉุณ ุฏฺฏูโุง ูฺฉุฑ ฺฉุฑุฏุ",
    "ุฏูุณุช ุฏุงุฑ ุฑุงุจุทูโููู ุฑู ฺุทูุฑ ูุฌุงูโุงูฺฏุฒุชุฑ ฺฉููุ",
    "ฺฉุฏูู ูุณูุช ุจุฏูุช ุฏูุณุช ุฏุงุฑ ุจุดุชุฑ ููุณ ุจุดูุ",
    "ุฌุง ุฎุงุต ูุณุช ฺฉู ุฏูุณุช ุฏุงุดุชู ุจุงุด ุฑุงุจุทู ุฏุงุดุชู ุจุงุดูุ",
    "ฺุฒ ูุณุช ฺฉู ุฏูุณุช ุฏุงุดุชู ุจุงุด ุฏุฑ ุฑุงุจุทู ุงูุชุญุงู ฺฉู ูู ุฑูุช ูุดุฏู ุจฺฏุ",
    "ุงููู ุจุงุฑ ฺฉู ุจุง ูู ุฑุงุจุทู ุฏุงุดุชุ ฺู ุญุณ ุฏุงุดุชุ",
    "ุงุฒ ูุธุฑ ุชู ุจูุชุฑู ุฑุงุจุทูโุง ฺฉู ุจุง ูู ุฏุงุดุชู ฺฉ ุจูุฏูุ",
    "ุงุฒ ฺุฒ ุชู ุฑุงุจุทูโููู ุฎุฌุงูุช ูโฺฉุดุ",
    "ุงุฒ ูุธุฑ ุนุงุทูุ ฺู ฺุฒ ุจุงุนุซ ูุดู ุจุดุชุฑ ุชุญุฑฺฉ ุจุดุ",
    "ุชุง ุญุงูุง ุจุฏูู ุงูฺฉู ูู ุจุฏูููุ ุงุฒ ฺุฒ ุชู ุฑุงุจุทูโููู ูุฐุช ูุจุฑุฏุ",
    "ุฏูุณุช ุฏุงุฑ ฺูุฏ ููุช ฺฉุจุงุฑ ุฑุงุจุทู ุฏุงุดุชู ุจุงุดูุ",
    "ฺุฒ ูุณุช ฺฉู ูู ุฏุฑ ุฑุงุจุทู ุงูุฌุงู ูุฏู ู ุชู ุฎูุดุช ููุงุฏุ",
    "ุงฺฏุฑ ุจุฎูุง ู ฺุฒ ุฌุฏุฏ ุชู ุฑุงุจุทู ุงูุชุญุงู ฺฉูุ ฺ ุงูุชุฎุงุจ ูโฺฉูุ",
    "ฺู ฺฉููุงุช ุง ุฌูููโูุง ุฏูุณุช ุฏุงุฑ ูููุน ุฑุงุจุทู ุจุดููุ",
    "ุฏูุณุช ุฏุงุฑ ูุจู ุงุฒ ุฑุงุจุทู ฺฺฉุงุฑ ฺฉููุ",
    "ุชุง ุญุงูุง ุชู ุฑุงุจุทูโููู ุจู ฺุฒ ูุงูููุฏ ฺฉุฑุฏุ",
    
    # ุณูุงูุงุช ุดุฎุต ู ุฑูุงูุดูุงุฎุช
    "ฺฉุฏูู ุชุฌุฑุจู ุฒูุฏฺฏุช ุจุดุชุฑ ุงุฒ ููู ุฑูุช ุชุฃุซุฑ ฺฏุฐุงุดุชูุ",
    "ฺู ฺุฒ ุจุงุนุซ ูุดู ููุช ุชููุง ฺฏุฑู ฺฉูุ",
    "ุณุฎุชโุชุฑู ฺุฒ ฺฉู ุชุง ุญุงูุง ุจู ฺฉุณ ฺฏูุช ฺ ุจูุฏูุ",
    "ฺู ฺุฒ ุจุงุนุซ ูุดู ุงุญุณุงุณ ุดฺฉุณุช ฺฉูุ",
    "ุขุง ุชุง ุญุงูุง ูฺฉุฑ ุฎูุฏฺฉุด ุฏุงุดุชุ",
    "ุขุง ุชุง ุญุงูุง ุจู ฺฉุณ ุฎุงูุช ฺฉุฑุฏุ",
    "ฺู ุงุชูุงู ุชู ุจฺฺฏ ุงูุชุงุฏู ฺฉู ูููุฒ ุฑูุช ุชุฃุซุฑ ุฏุงุฑูุ",
    "ฺู ฺุฒ ุชู ุฒูุฏฺฏ ุจุงุนุซ ูุดู ุงุญุณุงุณ ฺฏูุงู ฺฉูุ",
    "ุงุฒ ฺู ฺุฒ ุฏุฑ ุฎูุฏุช ุจุดุชุฑ ุงุฒ ููู ุดุฑููุฏูโุงุ",
    "ุงฺฏู ุจุชูู ู ุฑุงุฒ ุฑู ุงุฒ ูู ูุฎู ูฺฏู ุฏุงุฑุ ฺ ูุจูุฏุ",
    "ฺุฒ ูุณุช ฺฉู ูโุฎูุง ูู ุฏุฑ ููุฑุฏุด ุจุดุชุฑ ุฏุฑฺฉุช ฺฉููุ",
    "ฺฉุฏูู ุจุฎุด ุงุฒ ุดุฎุตุชุช ุฑู ุฏูุณุช ูุฏุงุฑ ุฏฺฏุฑุงู ุจุจููุ",
    "ฺู ฺุฒ ุจุงุนุซ ูุดู ุญุณ ฺฉู ฺฉู ุฒูุฏฺฏุช ุงุฑุฒุดููุฏูุ",
    "ููุช ุญุงูุช ุจุฏูุ ุชุฑุฌุญ ูุฏ ุชููุง ุจุงุด ุง ูพุด ููุ",
    "ฺู ฺุฒ ุจุดุชุฑ ุงุฒ ููู ุงุนุชูุงุฏ ุจู ููุณุช ุฑู ุงุฒ ุจู ูโุจุฑูุ",
    "ฺุทูุฑ ูโุชููู ุจูุช ฺฉูฺฉ ฺฉูู ููุช ุญุงูุช ุฎูุจ ูุณุชุ",
    "ฺู ฺฉุงุฑ ูโุชููู ุงูุฌุงู ุจุฏู ฺฉู ุจุดุชุฑ ุงุญุณุงุณ ุงููุช ฺฉูุ",
    "ุจุฒุฑฺฏุชุฑู ููุทู ุถุนูุช ฺูุ",
    
    # ุณูุงูุงุช ุฏุฑ ููุฑุฏ ฺฏุฐุดุชู
    "ุชูุฎโุชุฑู ุฎุงุทุฑู ุฒูุฏฺฏุช ฺูุ",
    "ุฑุงุจุทู ูุจูุช ฺุทูุฑ ุชููู ุดุฏุ",
    "ฺุฒ ุฏุฑ ฺฏุฐุดุชูโุงุช ูุณุช ฺฉู ุงุฒ ูู ูพููุงู ฺฉุฑุฏู ุจุงุดุ",
    "ุจุฏุชุฑู ุงุดุชุจุงู ฺฉู ุชู ุฒูุฏฺฏุช ฺฉุฑุฏ ฺ ุจูุฏูุ",
    "ฺฉุณ ุชู ฺฏุฐุดุชู ูุณุช ฺฉู ูููุฒ ุจูุด ูฺฉุฑ ฺฉูุ",
    "ฺุฒ ุฏุฑ ฺฏุฐุดุชูโุงุช ูุณุช ฺฉู ุขุฑุฒู ฺฉู ูู ูฺููุช ูููููุ",
    "ุงุฒ ฺฉุฏูู ุจุฎุด ุฒูุฏฺฏุช ุจุดุชุฑ ูพุดูููุ",
    "ุงฺฏู ูโุชููุณุช ุจู ฺฏุฐุดุชู ุจุฑฺฏุฑุฏุ ฺู ฺุฒ ุฑู ุชุบุฑ ูโุฏุงุฏุ",
    "ุฏุฑุจุงุฑู ุฑุงุจุทูโูุง ูุจูุช ฺุฒ ูุณุช ฺฉู ูู ูุฏูููุ",
    "ฺฉุฏูู ุฎุงุทุฑู ุงุฒ ุจฺฺฏุช ุจุดุชุฑ ุงุฒ ููู ุฏูุณุช ุฏุงุฑุ",
    "ฺุฒ ูุณุช ฺฉู ุชู ฺฏุฐุดุชู ุงุชูุงู ุงูุชุงุฏู ุจุงุดู ู ูููุฒ ุฑูุช ุชุฃุซุฑ ุฏุงุดุชู ุจุงุดูุ",
    "ฺู ุฏุฑูุบ ุจู ุฎุงููุงุฏูโุงุช ฺฏูุช ฺฉู ูููุฒ ููโุฏููู ุญููุช ฺูุ",
    "ุชู ฺฏุฐุดุชู ฺฉุงุฑ ุจุฏ ฺฉุฑุฏ ฺฉู ฺฉุณ ููโุฏูููุ",
    "ุชุง ุญุงูุง ฺฉุณ ุฑู ูุงูุนุงู ุงุฒ ุชู ุฏู ุจุฎุดุฏุ",
    "ุจุฏุชุฑู ุดฺฉุณุช ฺฉู ุฎูุฑุฏ ฺ ุจูุฏูุ",
    "ุงููู ุจูุณูโุงุช ุจุง ฺฉ ุจูุฏุ",
    "ุงููู ุนุดูุช ฺฉ ุจูุฏ ู ฺุฑุง ุชููู ุดุฏุ",
    "ฺู ุงุชูุงู ุชู ุฒูุฏฺฏุช ุงูุชุงุฏู ฺฉู ุจุงุนุซ ุดุฏู ุขุฏู ูุชูุงูุช ุจุดุ",
    "ฺู ฺฉุณ ุฏุฑ ฺฏุฐุดุชู ุจุดุชุฑู ุขุณุจ ุฑู ุจูุช ุฒุฏูุ",
    "ุงฺฏู ุจุดู ู ููุฑ ุงุฒ ฺฏุฐุดุชูโุงุช ุฑู ุฏูุจุงุฑู ุจุจูุ ฺฉ ุฑู ุงูุชุฎุงุจ ูโฺฉูุ",
    
    # ุณูุงูุงุช ูุงูุชุฒ ู ูุงุฌุฑุงุฌู
    "ุงฺฏู ุจุฑุง ฺฉ ุฑูุฒ ูุงูุฑุฆ ุจูุฏุ ฺฺฉุงุฑ ูโฺฉุฑุฏุ",
    "ุงฺฏู ูโุชููุณุช ู ุงุจุฑูุฏุฑุช ุฏุงุดุชู ุจุงุดุ ฺ ุงูุชุฎุงุจ ูโฺฉุฑุฏุ",
    "ุงฺฏู ุฏูุง ูุฑุฏุง ุชููู ูโุดุฏุ ุขุฎุฑู ฺฉุงุฑ ฺฉู ุจุง ูู ูโฺฉุฑุฏ ฺ ุจูุฏุ",
    "ุฌุณูุฑุงููโุชุฑู ฺฉุงุฑ ฺฉู ุฏูุณุช ุฏุงุฑ ุจุง ูู ุงูุฌุงู ุจุฏ ฺูุ",
    "ุฏูุณุช ุฏุงุฑ ฺฉุฌุง ุณูุฑ ฺฉูู ฺฉู ุชุง ุญุงูุง ูุฑูุชูุ",
    "ุฏูุณุช ุฏุงุฑ ฺู ูุงุฌุฑุงุฌู ุฑู ุจุง ูู ุชุฌุฑุจู ฺฉููุ",
    "ูุฌุงูโุงูฺฏุฒุชุฑู ฺุฒ ฺฉู ุฏูุณุช ุฏุงุฑ ุงูุชุญุงู ฺฉู ฺูุ",
    "ุงฺฏู ูโุชููุณุช ู ุงุฎุชุฑุงุน ุงูุฌุงู ุจุฏุ ฺ ุงุฎุชุฑุงุน ูโฺฉุฑุฏุ",
    "ุงฺฏู ู ูุงู ููุช ุขุฒุงุฏ ุฏุงุดุชุ ฺฺฉุงุฑ ูโฺฉุฑุฏุ",
    "ุงฺฏู ูโุชููุณุช ุชู ูุฑ ุฏูุฑูโุง ุงุฒ ุชุงุฑุฎ ุฒูุฏฺฏ ฺฉูุ ฺฉุฏูู ุฏูุฑู ุฑู ุงูุชุฎุงุจ ูโฺฉุฑุฏุ",
    
    # ุณูุงูุงุช ุฏุฑ ููุฑุฏ ุงุญุณุงุณุงุช ุนูู
    "ฺู ูููุนโูุง ุจุดุชุฑ ุงุญุณุงุณ ุชููุง ูโฺฉูุ ุญุช ููุช ุจุง ููุ",
    "ุขุฎุฑู ุจุงุฑ ฺฉู ฺฏุฑู ฺฉุฑุฏ ฺฉู ุจูุฏ ู ุจุฑุง ฺุ",
    "ฺุทูุฑ ูโุชููู ููุช ูุงุฑุงุญุชุ ุจูุชุฑ ุจูุช ฺฉูฺฉ ฺฉููุ",
    "ฺู ฺฉุงุฑ ูุชููู ุงูุฌุงู ุจุฏู ฺฉู ุจุดุชุฑ ุงุญุณุงุณ ฺฉู ุฏูุณุชุช ุฏุงุฑูุ",
    "ุจุฒุฑฺฏุชุฑู ูฺฏุฑุงูุช ุฏุฑ ููุฑุฏ ุขูุฏู ฺูุ",
    "ฺู ูููุนโูุง ุงุญุณุงุณ ุขุฑุงูุด ูโฺฉูุ",
    "ฺู ฺฉุงุฑ ูู ุงูุฌุงู ูุฏู ฺฉู ูุงุฎูุฏุขฺฏุงู ุงุฐุชุช ูโฺฉููุ",
    "ุจุฒุฑฺฏุชุฑู ุฏูู ฺฉู ุจุงุนุซ ูุดู ุจุฎูุง ุจุง ูู ุจููู ฺูุ",
    "ุงุฒ ฺู ฺุฒูุง ุนููุงู ูพุดูููุ",
    "ฺู ูููุนโูุง ุจุดุชุฑ ุงุฒ ููู ุงุญุณุงุณ ูโฺฉู ฺฉู ุฏูุณุชุช ุฏุงุฑูุ",
    "ฺุทูุฑ ูโุชููู ููุช ุนุตุจุงู ูุณุชุ ุจูุชุฑ ฺฉูฺฉุช ฺฉููุ",
    "ููุช ุจุง ููุ ุงุฒ ฺู ฺุฒ ูโุชุฑุณุ",
    "ุนููโุชุฑู ุขุฑุฒูุช ฺฉู ุชุง ุญุงูุง ุจู ฺฉุณ ูฺฏูุช ฺูุ",
    
    # ุณูุงูุงุช ุฏุฑ ููุฑุฏ ูุณุงุฆู ุญุณุงุณ
    "ูุธุฑุช ุฏุฑ ููุฑุฏ ูุฑุฒูุฏุฎูุงูุฏู ฺฏุฑูุชู ฺูุ",
    "ุงฺฏู ฺฉ ุงุฒ ูุง ูุชููู ุจฺูโุฏุงุฑ ุจุดูุ ฺู ุงุญุณุงุณ ุฎูุงู ุฏุงุดุชุ",
    "ุจู ูุธุฑุช ูุณุงุฆู ูุงู ุจุงุฏ ุจู ุฒูุฌโูุง ฺุทูุฑ ูุฏุฑุช ุจุดูุ",
    "ุฏุฑ ููุฑุฏ ุฑูุงุจุท ุจุงุฒ ฺู ูุธุฑ ุฏุงุฑุ",
    "ุงฺฏู ูู ุจู ูุดฺฉู ุฌุฏ ุณูุงูุช ุจุฑุฎูุฑุฏ ฺฉููุ ฺู ูุงฺฉูุด ูุดูู ูุฏุ",
    "ูุธุฑุช ุฏุฑ ููุฑุฏ ูุฐูุจ ู ููุดุด ุชู ุฒูุฏฺฏ ูุดุชุฑฺฉููู ฺูุ",
    "ุงฺฏู ูู ุชุบุฑ ุนูุฏู ุณุงุณ ุจุฏูุ ฺู ูุงฺฉูุด ูุดูู ูุฏุ",
    "ฺูุฏุฑ ุจุฑุงุช ูููู ฺฉู ุฎุงููุงุฏูโุงุช ูู ุฑู ุชุฃุฏ ฺฉููุ",
    "ุงฺฏู ูู ู ุงุดุชุจุงู ุจุฒุฑฺฏ ูุฑุชฺฉุจ ุจุดูุ ฺูุฏุฑ ูโุชูู ูู ุฑู ุจุจุฎุดุ",
    "ุงฺฏู ุจุฎูุงู ุดุบูู ุฑู ุนูุถ ฺฉููุ ฺู ูุงฺฉูุด ูุดูู ูุฏุ",
    "ุงฺฏู ูู ุจู ุงูุณุฑุฏฺฏ ุง ุงุถุทุฑุงุจ ูุจุชูุง ุจุดูุ ฺุทูุฑ ฺฉูฺฉู ูโฺฉูุ",
    "ุฏุฑ ููุฑุฏ ูุณุงุฆู ุญุณุงุณ ูุซู ุทูุงู ฺู ูุธุฑ ุฏุงุฑุ",
    "ุงฺฏู ฺฉ ุงุฒ ูุฒุฏฺฉุงูุช ุจุง ูู ูุดฺฉู ุฏุงุดุชู ุจุงุดูุ ฺฺฉุงุฑ ูโฺฉูุ",
    "ุขุง ุญุงุถุฑ ุจู ุฎุงุทุฑ ูู ุงุฒ ุจุฑุฎ ุงูุฏุงูุช ุฏุณุช ุจฺฉุดุ",
    "ุขุง ุฏุฑ ููุฑุฏ ุฏุงุดุชู ุญุณุงุจ ุจุงูฺฉ ูุดุชุฑฺฉ ุงุญุณุงุณ ุฑุงุญุช ูโฺฉูุ",
    "ุฏุฑ ููุฑุฏ ุฑุงุจุทู ุจุง ุฌูุณ ูุฎุงูู ููุช ุชู ุฑุงุจุทู ูุณุช ฺู ูุธุฑ ุฏุงุฑุ",
    "ุจู ูุธุฑุช ุตุญุจุช ุจุง ูพุงุฑุชูุฑ ูุจู ูุงุจู ูุจููู ุง ููุ",
    "ุขุง ุญุงุถุฑ ุจุนุฏ ุงุฒ ุงุฒุฏูุงุฌ ูุญู ุฒูุฏฺฏุช ุฑู ุชุบุฑ ุจุฏุ",
    "ุงฺฏู ูู ุจุฎูุงู ุณุจฺฉ ุฒูุฏฺฏู ุฑู ุจู ุทูุฑ ุงุณุงุณ ุชุบุฑ ุจุฏูุ ฺู ูุงฺฉูุด ูุดูู ูุฏุ",
    
    # ุณูุงูุงุช ุฏุฑ ููุฑุฏ ุฑุดุฏ ุดุฎุต
    "ฺู ฺุฒ ุฏุฑ ููุฑุฏ ุฎูุฏุช ุฏูุณุช ุฏุงุฑ ุชุบุฑ ุจุฏุ",
    "ุจุฒุฑฺฏุชุฑู ูุฏู ฺฉู ุฏุงุฑ ฺู ู ฺุทูุฑ ูโุฎูุง ุจูุด ุจุฑุณุ",
    "ฺุทูุฑ ูโุชููู ุจูุช ฺฉูฺฉ ฺฉูู ุชุง ุจู ูุฏูโูุงุช ุจุฑุณุ",
    "ฺู ุนุงุฏุช ุจุฏ ุฏุงุฑ ฺฉู ูโุฎูุง ุชุฑฺฉุด ฺฉูุ",
    "ฺุทูุฑ ูโุชููู ููุฏฺฏู ุฑู ุจุฑุง ุฑุดุฏ ุดุฎุต ุชุดูู ฺฉููุ",
    "ฺู ููุงุฑุชโูุง ุฏูุณุช ุฏุงุฑ ุงุฏ ุจฺฏุฑุ",
    "ุจู ูุธุฑุช ูู ฺู ฺุฒ ูโุชููู ุงุฒ ุชู ุงุฏ ุจฺฏุฑูุ",
    "ฺู ููุงุท ููุช ุชู ูู ูโุจู ฺฉู ุฎูุฏู ูุชูุฌูุดูู ูุณุชูุ",
    "ฺฉุฏูู ฺฉ ุงุฒ ููุงุท ุถุนูุช ุฑู ุฏูุณุช ุฏุงุฑ ุจูุจูุฏ ุจุฏุ",
    "ฺุทูุฑ ูโุชููู ุจู ููููุช ุชู ฺฉูฺฉ ฺฉููุ",
    "ฺู ฺุฒ ุชู ุฑุงุจุทูโููู ุจุงุนุซ ูุดู ฺฉู ุฑุดุฏ ฺฉูุ",
    "ฺ ุจุงุนุซ ูุดู ุงุญุณุงุณ ููููุช ฺฉูุ",
    "ฺุทูุฑ ูโุชููู ุจู ุนููุงู ู ุฒูุฌ ุฑุดุฏ ฺฉููุ",
    "ุจุฒุฑฺฏุชุฑู ุฏุฑุณ ฺฉู ุงุฒ ุฑุงุจุทูโููู ฺฏุฑูุช ฺูุ",
    "ฺู ฺุฒ ูู ูโุชููู ุงุฒ ุชู ุงุฏ ุจฺฏุฑูุ",
    "ฺุทูุฑ ูโุชููู ุฏุฑ ุฌูุช ุฑุดุฏ ุดุฎุตุชุช ุจูุช ฺฉูฺฉ ฺฉููุ",
    "ุงุฒ ูุธุฑ ูุนููุ ฺู ุชุฌุฑุจูโุง ุจุฑุงุช ููู ุจูุฏูุ"
]

def generate_unique_code():
    """ ุชููุฏ ฺฉุฏ ฺฉุชุง ุจุฑุง ฺฉุงุฑุจุฑ """
    return ''.join(random.choices(string.ascii_uppercase + string.digits, k=6))

async def check_subscription(user_id):
    """ ุจุฑุฑุณ ูุถุนุช ุนุถูุช ฺฉุงุฑุจุฑ ุฏุฑ ฺฉุงูุงู ุงุฌุจุงุฑ """
    try:
        member = await bot.get_chat_member(REQUIRED_CHANNEL, user_id)
        return member.status in ["member", "administrator", "creator"]
    except Exception as e:
        logging.error(f"ุฎุทุง ุฏุฑ ุจุฑุฑุณ ุนุถูุช ฺฉุงุฑุจุฑ {user_id}: {e}")
        return False

def get_subscription_keyboard():
    """ ุงุฌุงุฏ ุฏฺฉูู ุจุฑุง ุนุถูุช ุฏุฑ ฺฉุงูุงู """
    keyboard = InlineKeyboardMarkup(
        inline_keyboard=[
            [InlineKeyboardButton(text=f"๐ ุนุถูุช ุฏุฑ {CHANNEL_TITLE}", url=f"https://t.me/{REQUIRED_CHANNEL.replace('@', '')}")],
            [InlineKeyboardButton(text="โ ุจุฑุฑุณ ูุฌุฏุฏ ุนุถูุช", callback_data="check_subscription")]
        ]
    )
    return keyboard

async def check_user_subscription(message: types.Message):
    """ุจุฑุฑุณ ุนุถูุช ฺฉุงุฑุจุฑ ู ุงุฑุณุงู ูพุงู ุฏุฑ ุตูุฑุช ุนุฏู ุนุถูุช"""
    user_id = message.from_user.id
    is_subscribed = await check_subscription(user_id)
    
    if not is_subscribed:
        subscription_keyboard = get_subscription_keyboard()
        await message.answer(
            f"โ๏ธ ุจุฑุง ุงุณุชูุงุฏู ุงุฒ ุฑุจุงุชุ ุงุจุชุฏุง ุจุงุฏ ุฏุฑ ฺฉุงูุงู {CHANNEL_TITLE} ุนุถู ุดูุฏ.",
            reply_markup=subscription_keyboard
        )
        return False
    
    return True

async def send_question(user_id, partner_id, force=False):
    """ ุงุฑุณุงู ุณูุงู ฺุงูุด ุจู ุฏู ูพุงุฑุชูุฑ """
    
    try:
        # ุจุฑุฑุณ ุขุง ฺฉุงุฑุจุฑุงู ุณูุงู ุจโูพุงุณุฎ ุฏุงุฑูุฏ
        cursor.execute("SELECT id, question, timestamp FROM questions WHERE user_id = ? AND partner_id = ? AND answer IS NULL", (user_id, partner_id))
        unanswered_user = cursor.fetchone()
        
        cursor.execute("SELECT id, question, timestamp FROM questions WHERE user_id = ? AND partner_id = ? AND answer IS NULL", (partner_id, user_id))
        unanswered_partner = cursor.fetchone()
        
        # ุงฺฏุฑ ฺฉุงุฑุจุฑ ุงุตู ุณูุงู ุจโูพุงุณุฎ ุฏุงุฑุฏุ ุงุฒ ุงุฑุณุงู ุณูุงู ุฌุฏุฏ ุฎูุฏุฏุงุฑ ฺฉู
        if unanswered_user or unanswered_partner:
            # ููุท ุงุทูุงุนโุฑุณุงู ฺฉูู ฺฉู ุณูุงู ุจโูพุงุณุฎ ูุฌูุฏ ุฏุงุฑุฏุ ุจุฏูู ุงุฑุณุงู ุงุฏุขูุฑ
            # ุงุฏุขูุฑโูุง ุชูุณุท ุชุงุจุน send_reminders ูุฑ 5 ุณุงุนุช ุงุฑุณุงู ูโุดููุฏ
            return False
        
        # ุจุฑุฑุณ ุฒูุงู ุขุฎุฑู ุณูุงู ุจุฑุง ุฌููฺฏุฑ ุงุฒ ุงุฑุณุงู ุณูุงู ุฏุฑ ฺฉูุชุฑ ุงุฒ ฒ ุณุงุนุช
        current_time = int(time.time())
        cursor.execute("SELECT last_question_time FROM users WHERE user_id = ?", (user_id,))
        result = cursor.fetchone()
        last_question_time_user = 0 if result is None else result[0]
        
        two_hours_in_seconds = 7200  # 2 ุณุงุนุช
        
        # ุงฺฏุฑ force=True ุจุงุดุฏ ุง ฺฉูุชุฑ ุงุฒ ุฏู ุณุงุนุช ุงุฒ ุขุฎุฑู ุณูุงู ฺฏุฐุดุชูุ ุณูุงู ุฌุฏุฏ ุงุฑุณุงู ฺฉู (ุจู ุฌุฒ ุงููู ุณูุงู)
        if not force and last_question_time_user != 0 and (current_time - last_question_time_user) < two_hours_in_seconds:
            return False
            
        # ุงฺฏุฑ ูุฑ ุฏู ฺฉุงุฑุจุฑ ุจู ุณูุงูุงุช ูุจู ูพุงุณุฎ ุฏุงุฏูโุงูุฏุ ุณูุงู ุฌุฏุฏ ุงุฑุณุงู ฺฉู
        question = random.choice(questions)
        
        # ุงุฌุงุฏ ุณูุงู ุฌุฏุฏ ุจุฑุง ูุฑ ุฏู ฺฉุงุฑุจุฑ
        cursor.execute("INSERT INTO questions (user_id, partner_id, question, timestamp) VALUES (?, ?, ?, ?)", (user_id, partner_id, question, current_time))
        question_id_1 = cursor.lastrowid
        
        cursor.execute("INSERT INTO questions (user_id, partner_id, question, timestamp) VALUES (?, ?, ?, ?)", (partner_id, user_id, question, current_time))
        question_id_2 = cursor.lastrowid
        
        # ุจุฑูุฒุฑุณุงู ุฒูุงู ุขุฎุฑู ุณูุงู ุจุฑุง ูุฑ ุฏู ฺฉุงุฑุจุฑ
        cursor.execute("UPDATE users SET last_question_time = ? WHERE user_id = ?", (current_time, user_id))
        cursor.execute("UPDATE users SET last_question_time = ? WHERE user_id = ?", (current_time, partner_id))
        
        conn.commit()
        
        # ุงุฑุณุงู ุณูุงู ุจู ฺฉุงุฑุจุฑุงู
        try:
            await bot.send_message(user_id, f"๐ฌ ุณูุงู ุฌุฏุฏ: {question}\nโ๏ธ ูพุงุณุฎ ุฎูุฏ ุฑุง ุงุฑุณุงู ฺฉูุฏ.")
        except Exception as e:
            print(f"ุฎุทุง ุฏุฑ ุงุฑุณุงู ุณูุงู ุจู ฺฉุงุฑุจุฑ {user_id}: {e}")
        
        try:
            await bot.send_message(partner_id, f"๐ฌ ุณูุงู ุฌุฏุฏ: {question}\nโ๏ธ ูพุงุณุฎ ุฎูุฏ ุฑุง ุงุฑุณุงู ฺฉูุฏ.")
        except Exception as e:
            print(f"ุฎุทุง ุฏุฑ ุงุฑุณุงู ุณูุงู ุจู ฺฉุงุฑุจุฑ {partner_id}: {e}")
        
        # ุฏุฑุงูุช ุงุทูุงุนุงุช ฺฉุงุฑุจุฑุงู
        try:
            user_info = await bot.get_chat(user_id)
            user_identifier = user_info.username if user_info.username else user_info.first_name
        except:
            user_identifier = str(user_id)
            
        try:
            partner_info = await bot.get_chat(partner_id)
            partner_identifier = partner_info.username if partner_info.username else partner_info.first_name
        except:
            partner_identifier = str(partner_id)
        
        # ุงุฑุณุงู ูพุงู ุจู ุงุฏูู ุจุง ูุงู ฺฉุงุฑุจุฑ ุง ูุงู
        await bot.send_message(SUPPORT_CHAT_ID, f"๐ ุณูุงู ุฌุฏุฏ ุจู ฺฉุงุฑุจุฑุงู {user_identifier} ู {partner_identifier} ุงุฑุณุงู ุดุฏ:\n{question}")
        
        return True
        
    except Exception as e:
        print(f"ุฎุทุง ุฏุฑ ุงุฑุณุงู ุณูุงู: {e}")
        return False

async def scheduled_questions():
    """ ุงุฑุณุงู ุณูุงู ูุฑ ฒ ุณุงุนุช ฺฉ ุจุงุฑ """
    while True:
        cursor.execute("SELECT user_id, partner_id, last_question_time FROM users WHERE partner_id IS NOT NULL")
        pairs = cursor.fetchall()

        # ุจุฑุง ุฌููฺฏุฑ ุงุฒ ุงุฑุณุงู ุณูุงู ุชฺฉุฑุงุฑ ุจู ุฒูุฌโูุง
        processed_pairs = set()
        current_time = int(time.time())
        two_hours_in_seconds = 7200  # 2 ุณุงุนุช ุจู ุซุงูู
        
        for user_id, partner_id, last_question_time in pairs:
            # ุงุฌุงุฏ ฺฉ ฺฉูุฏ ููุญุตุฑ ุจู ูุฑุฏ ุจุฑุง ูุฑ ุฒูุฌ (ุจุง ูุฑุชุจโุณุงุฒ ุดูุงุณูโูุง)
            pair_key = tuple(sorted([user_id, partner_id]))
            
            # ุงฺฏุฑ ุงู ุฒูุฌ ูุจูุงู ูพุฑุฏุงุฒุด ูุดุฏูโุงูุฏ ู ุฒูุงู ฺฉุงู ุงุฒ ุขุฎุฑู ุณูุงู ฺฏุฐุดุชู ุงุณุช
            if pair_key not in processed_pairs:
                # ุงฺฏุฑ ูุฑฺฏุฒ ุณูุงู ุฏุฑุงูุช ูฺฉุฑุฏูโุงูุฏ ุง ุฒูุงู ฺฉุงู ฺฏุฐุดุชู ุงุณุช
                if last_question_time == 0 or (current_time - last_question_time) >= two_hours_in_seconds:
                    await send_question(user_id, partner_id)
                processed_pairs.add(pair_key)

        await asyncio.sleep(300)  # ุจุฑุฑุณ ูุฑ ต ุฏููู (ุจุฑุง ฺฉุงูุด ูุตุฑู ููุงุจุน)

async def send_reminders():
    """ ุงุฑุณุงู ุงุฏุขูุฑ ูุฑ ต ุณุงุนุช ุจุฑุง ุณูุงูุงุช ุจโูพุงุณุฎ """
    while True:
        # ุงุจุชุฏุง ููุชุธุฑ ูโูุงูู ุชุง 5 ุณุงุนุช ุจฺฏุฐุฑุฏ
        await asyncio.sleep(18000)  # ุงูุชุธุงุฑ ต ุณุงุนุช (18000 ุซุงูู)
        
        # ุณูพุณ ุจุฑุฑุณ ู ุงุฑุณุงู ุงุฏุขูุฑโูุง
        cursor.execute("SELECT q.id, q.user_id, q.partner_id, q.question, q.timestamp FROM questions q WHERE q.answer IS NULL")
        unanswered_questions = cursor.fetchall()
        current_time = int(time.time())
        five_hours_in_seconds = 18000  # 5 ุณุงุนุช ุจู ุซุงูู
        two_hours_in_seconds = 7200  # 2 ุณุงุนุช ุจู ุซุงูู
        
        for question_id, user_id, partner_id, question, timestamp in unanswered_questions:
            # ุจุฑุฑุณ ุขุง ุญุฏุงูู 2 ุณุงุนุช ุงุฒ ุงุฌุงุฏ ุณูุงู ฺฏุฐุดุชู ุงุณุช
            if timestamp and (current_time - timestamp) >= two_hours_in_seconds:
                try:
                    await bot.send_message(user_id, f"๐ ุงุฏุขูุฑ ูุฌุฏุฏ: ุดูุง ูููุฒ ุจู ุงู ุณูุงู ูพุงุณุฎ ูุฏุงุฏูโุงุฏ:\n\n{question}\n\nโ๏ธ ูุทูุงู ูพุงุณุฎ ุฎูุฏ ุฑุง ุงุฑุณุงู ฺฉูุฏ.")
                    # ุจูโุฑูุฒุฑุณุงู ุฒูุงู ุขุฎุฑู ุงุฏุขูุฑ
                    cursor.execute("UPDATE questions SET timestamp = ? WHERE id = ?", (current_time, question_id))
                    conn.commit()
                except Exception as e:
                    logging.error(f"ุฎุทุง ุฏุฑ ุงุฑุณุงู ุงุฏุขูุฑ ุจู ฺฉุงุฑุจุฑ {user_id}: {e}")
        
        await asyncio.sleep(18000)  # ุจุฑุฑุณ ูุฑ ต ุณุงุนุช (18000 ุซุงูู)

@dp.message(Command("start"))
async def start(message: types.Message):
    """ ุซุจุชโูุงู ู ุงุฌุงุฏ ฺฉุฏ ุงุฎุชุตุงุต """
    user_id = message.from_user.id
    is_new_user = False
    
    # ุจุฑุฑุณ ุนุถูุช ฺฉุงุฑุจุฑ ุฏุฑ ฺฉุงูุงู
    is_subscribed = await check_subscription(user_id)
    if not is_subscribed:
        subscription_keyboard = get_subscription_keyboard()
        await message.answer(
            f"ุณูุงู {message.from_user.first_name}!\n\nโ๏ธ ุจุฑุง ุงุณุชูุงุฏู ุงุฒ ุฑุจุงุชุ ุงุจุชุฏุง ุจุงุฏ ุฏุฑ ฺฉุงูุงู {CHANNEL_TITLE} ุนุถู ุดูุฏ.",
            reply_markup=subscription_keyboard
        )
        return
    
    # ุงุฏุงูู ุฑููุฏ ูุนููู
    cursor.execute("SELECT unique_code, partner_id FROM users WHERE user_id=?", (user_id,))
    user_data = cursor.fetchone()

    if not user_data:
        is_new_user = True
        unique_code = generate_unique_code()
        cursor.execute("INSERT INTO users (user_id, unique_code) VALUES (?, ?)", (user_id, unique_code))
        conn.commit()
        partner_id = None
    else:
        unique_code, partner_id = user_data

    partner_status = "โ ูฺ ูพุงุฑุชูุฑ ูุฏุงุฑุฏ." if not partner_id else f"โ ุดูุง ูุชุตู ูุณุชุฏ ุจู: [{partner_id}](tg://user?id={partner_id})"

    # ุงุฌุงุฏ ุฏฺฉููโูุง ููู ุงุตู ุจุง ุงุณุชูุงุฏู ุงุฒ ุชุงุจุน ุฌุฏุฏ
    if user_id == ADMIN_ID:
        menu = get_admin_menu_keyboard()
    else:
        menu = get_main_menu_keyboard()
    
    # ุชุนุฑู ุฏฺฉููโูุง ุงููุงู
    inline_buttons = InlineKeyboardMarkup(
        inline_keyboard=[
            [InlineKeyboardButton(text="๐จ ุงุฑุณุงู ุฏุนูุชูุงูู", callback_data="send_invitation")]
        ]
    )
    
    await message.answer(
        f"ุณูุงู {message.from_user.first_name}!\n\n๐ **ฺฉุฏ ุงุฎุชุตุงุต ุดูุง:** {unique_code}\n๐จ ุงู ฺฉุฏ ุฑุง ุจุฑุง ูพุงุฑุชูุฑุช ุจูุฑุณุช ุชุง ูุชุตู ุดูุฏ.\n\n{partner_status}\n\n"
        f"ุจุฑุง ุงุชุตุงู ุจู ูพุงุฑุชูุฑ ุฑู ุฏฺฉูู '/connect - ๐ ุงุชุตุงู ุจู ูพุงุฑุชูุฑ' ฺฉูฺฉ ฺฉูุฏ ุง ุฏุณุชูุฑ /connect ุฑุง ุงุฑุณุงู ฺฉูุฏ.",
        parse_mode="Markdown", reply_markup=menu
    )
    
    # ุงุฑุณุงู ูพุงู ุฏูู ุจุง ุฏฺฉูู ุดุดูโุง
    await message.answer("ุจุฑุง ุงุฑุณุงู ุฏุนูุชูุงูู ุจู ูพุงุฑุชูุฑุ ุงุฒ ุฏฺฉูู ุฒุฑ ุงุณุชูุงุฏู ฺฉูุฏ:", reply_markup=inline_buttons)
    
    # ุงุทูุงุน ุจู ุงุฏูู ููุท ุฏุฑ ุตูุฑุช ุซุจุช ูุงู ุฌุฏุฏ
    if is_new_user:
        await bot.send_message(
            SUPPORT_CHAT_ID, 
            f"๐ค ฺฉุงุฑุจุฑ ุฌุฏุฏ ุซุจุชโูุงู ฺฉุฑุฏ:\nูุงู: {message.from_user.first_name}\nุขุฏ: {user_id}\nูุฒุฑูู: @{message.from_user.username or 'ูุฏุงุฑุฏ'}"
        )

@dp.message(Command("connect"))
async def connect_partner_cmd(message: types.Message):
    """ ูุฏุฑุช ุฏุฑุฎูุงุณุช ุงุชุตุงู ุจู ูพุงุฑุชูุฑ """
    # ุจุฑุฑุณ ุนุถูุช ฺฉุงุฑุจุฑ ุฏุฑ ฺฉุงูุงู
    if not await check_user_subscription(message):
        return
    
    user_id = message.from_user.id
    cursor.execute("SELECT partner_id FROM users WHERE user_id=?", (user_id,))
    partner = cursor.fetchone()
    
    if partner and partner[0]:
        # ุงุฌุงุฏ ุฏฺฉูู ุจุฑุง ูุทุน ุงุฑุชุจุงุท
        keyboard = InlineKeyboardMarkup(
            inline_keyboard=[
                [InlineKeyboardButton(text="โ ูุทุน ุงุฑุชุจุงุท ุจุง ูพุงุฑุชูุฑ ูุนู", callback_data="disconnect_partner")]
            ]
        )
        await message.answer("โ๏ธ ุดูุง ุฏุฑ ุญุงู ุญุงุถุฑ ุจู ฺฉ ูพุงุฑุชูุฑ ูุชุตู ูุณุชุฏ. ุจุฑุง ุงุชุตุงู ุจู ูพุงุฑุชูุฑ ุฌุฏุฏุ ุงุจุชุฏุง ุงุฑุชุจุงุท ูุนู ุฑุง ูุทุน ฺฉูุฏ.", reply_markup=keyboard)
        return
    
    # ูุนุงู ฺฉุฑุฏู ุญุงูุช ุงูุชุธุงุฑ ุจุฑุง ฺฉุฏ
    cursor.execute("UPDATE users SET waiting_for_code = 1 WHERE user_id = ?", (user_id,))
    conn.commit()
    
    await message.answer("๐ ูุทูุงู ฺฉุฏ ุงุฎุชุตุงุต ูพุงุฑุชูุฑ ุฎูุฏ ุฑุง ูุงุฑุฏ ฺฉูุฏ:")

@dp.message(Command("manage"))
async def manage_partner_cmd(message: types.Message):
    """ ูุฏุฑุช ูพุงุฑุชูุฑ """
    # ุจุฑุฑุณ ุนุถูุช ฺฉุงุฑุจุฑ ุฏุฑ ฺฉุงูุงู
    if not await check_user_subscription(message):
        return
    
    user_id = message.from_user.id
    cursor.execute("SELECT partner_id FROM users WHERE user_id=?", (user_id,))
    partner = cursor.fetchone()
    
    if not partner or not partner[0]:
        await message.answer("โ๏ธ ุดูุง ูููุฒ ุจู ูพุงุฑุชูุฑ ูุชุตู ูุดุฏูโุงุฏ.")
        return
    
    # ุงุฌุงุฏ ุฏฺฉูู ุจุฑุง ูุทุน ุงุฑุชุจุงุท
    keyboard = InlineKeyboardMarkup(
        inline_keyboard=[
            [InlineKeyboardButton(text="โ ูุทุน ุงุฑุชุจุงุท ุจุง ูพุงุฑุชูุฑ", callback_data="disconnect_partner")]
        ]
    )
    
    await message.answer("๐ ูุฏุฑุช ูพุงุฑุชูุฑ:", reply_markup=keyboard)

@dp.callback_query(lambda c: c.data == "disconnect_partner")
async def disconnect_partner(callback: types.CallbackQuery):
    """ ูุทุน ุงุฑุชุจุงุท ุจุง ูพุงุฑุชูุฑ """
    user_id = callback.from_user.id
    cursor.execute("SELECT partner_id FROM users WHERE user_id=?", (user_id,))
    partner = cursor.fetchone()
    
    if partner and partner[0]:
        partner_id = partner[0]
        
        # ูุทุน ุงุฑุชุจุงุท ุฏู ุทุฑูู
        cursor.execute("UPDATE users SET partner_id = NULL WHERE user_id = ?", (user_id,))
        cursor.execute("UPDATE users SET partner_id = NULL WHERE user_id = ?", (partner_id,))
        conn.commit()
        
        # ุฏุฑุงูุช ุงุทูุงุนุงุช ฺฉุงุฑุจุฑุงู ุจุฑุง ุงุทูุงุนโุฑุณุงู ุจูุชุฑ
        try:
            user_info = await bot.get_chat(user_id)
            user_identifier = user_info.username if user_info.username else user_info.first_name
        except:
            user_identifier = str(user_id)
            
        try:
            partner_info = await bot.get_chat(partner_id)
            partner_identifier = partner_info.username if partner_info.username else partner_info.first_name
        except:
            partner_identifier = str(partner_id)
        
        # ุงุฌุงุฏ ุฏฺฉูู ุจุฑุง ุงุชุตุงู ุจู ูพุงุฑุชูุฑ ุฌุฏุฏ
        connect_keyboard = InlineKeyboardMarkup(
            inline_keyboard=[
                [InlineKeyboardButton(text="๐ ุงุชุตุงู ุจู ูพุงุฑุชูุฑ ุฌุฏุฏ", callback_data="start_connect")]
            ]
        )
        
        await callback.message.edit_text("โ ุงุฑุชุจุงุท ุดูุง ุจุง ูพุงุฑุชูุฑ ูุทุน ุดุฏ.")
        await bot.send_message(user_id, "โ ุงฺฉููู ูโุชูุงูุฏ ุจุง ุงุณุชูุงุฏู ุงุฒ ุฏุณุชูุฑ /connect ุจู ูพุงุฑุชูุฑ ุฌุฏุฏ ูุชุตู ุดูุฏ.", reply_markup=connect_keyboard)
        await bot.send_message(partner_id, f"โ๏ธ ูพุงุฑุชูุฑ ุดูุง ({user_identifier}) ุงุฑุชุจุงุท ุฑุง ูุทุน ฺฉุฑุฏ. ุดูุง ูโุชูุงูุฏ ุจุง ุงุณุชูุงุฏู ุงุฒ ุฏุณุชูุฑ /connect ุจู ูพุงุฑุชูุฑ ุฌุฏุฏ ูุชุตู ุดูุฏ.")
        
        # ุงุทูุงุน ุจู ุงุฏูู
        await bot.send_message(SUPPORT_CHAT_ID, f"๐ ุงุฑุชุจุงุท ุจู {user_identifier} ู {partner_identifier} ูุทุน ุดุฏ.")
    else:
        await callback.message.edit_text("โ๏ธ ุดูุง ุจู ูพุงุฑุชูุฑ ูุชุตู ูุณุชุฏ.")
    
    await callback.answer()

@dp.callback_query(lambda c: c.data == "start_connect")
async def start_connect_callback(callback: types.CallbackQuery):
    """ ุดุฑูุน ูุฑุขูุฏ ุงุชุตุงู ุจู ูพุงุฑุชูุฑ ุฌุฏุฏ """
    user_id = callback.from_user.id
    
    # ุจุฑุฑุณ ุงูฺฉู ุขุง ฺฉุงุฑุจุฑ ูพุงุฑุชูุฑ ุฏุงุฑุฏ
    cursor.execute("SELECT partner_id FROM users WHERE user_id=?", (user_id,))
    partner = cursor.fetchone()
    
    if partner and partner[0]:
        # ุงุฌุงุฏ ุฏฺฉูู ุจุฑุง ูุทุน ุงุฑุชุจุงุท
        keyboard = InlineKeyboardMarkup(
            inline_keyboard=[
                [InlineKeyboardButton(text="โ ูุทุน ุงุฑุชุจุงุท ุจุง ูพุงุฑุชูุฑ ูุนู", callback_data="disconnect_partner")]
            ]
        )
        await callback.message.edit_text("โ๏ธ ุดูุง ุฏุฑ ุญุงู ุญุงุถุฑ ุจู ฺฉ ูพุงุฑุชูุฑ ูุชุตู ูุณุชุฏ. ุจุฑุง ุงุชุตุงู ุจู ูพุงุฑุชูุฑ ุฌุฏุฏุ ุงุจุชุฏุง ุงุฑุชุจุงุท ูุนู ุฑุง ูุทุน ฺฉูุฏ.", reply_markup=keyboard)
        await callback.answer()
        return
    
    # ูุนุงู ฺฉุฑุฏู ุญุงูุช ุงูุชุธุงุฑ ุจุฑุง ฺฉุฏ
    cursor.execute("UPDATE users SET waiting_for_code = 1 WHERE user_id = ?", (user_id,))
    conn.commit()
    
    await callback.message.edit_text("๐ ูุทูุงู ฺฉุฏ ุงุฎุชุตุงุต ูพุงุฑุชูุฑ ุฎูุฏ ุฑุง ูุงุฑุฏ ฺฉูุฏ:")
    await callback.answer()

@dp.callback_query(lambda c: c.data == "check_subscription")
async def check_subscription_callback(callback: types.CallbackQuery):
    """ ุจุฑุฑุณ ูุฌุฏุฏ ุนุถูุช ฺฉุงุฑุจุฑ ุฏุฑ ฺฉุงูุงู """
    user_id = callback.from_user.id
    is_subscribed = await check_subscription(user_id)
    
    if is_subscribed:
        # ุจุฑุฑุณ ู ุงุฌุงุฏ ฺฉุงุฑุจุฑ ุงฺฏุฑ ูุฌูุฏ ูุฏุงุดุชู ุจุงุดุฏ
        cursor.execute("SELECT unique_code, partner_id FROM users WHERE user_id=?", (user_id,))
        user_data = cursor.fetchone()

        if not user_data:
            unique_code = generate_unique_code()
            cursor.execute("INSERT INTO users (user_id, unique_code) VALUES (?, ?)", (user_id, unique_code))
            conn.commit()
            partner_id = None
        else:
            unique_code, partner_id = user_data
        
        partner_status = "โ ูฺ ูพุงุฑุชูุฑ ูุฏุงุฑุฏ." if not partner_id else f"โ ุดูุง ูุชุตู ูุณุชุฏ ุจู: [{partner_id}](tg://user?id={partner_id})"
        
        await callback.message.edit_text("โ ุนุถูุช ุดูุง ุฏุฑ ฺฉุงูุงู ุชุงุฏ ุดุฏ. ุญุงูุง ูโุชูุงูุฏ ุงุฒ ุฑุจุงุช ุงุณุชูุงุฏู ฺฉูุฏ!")
        await callback.answer("โ ุนุถูุช ุชุงุฏ ุดุฏ")
        
        # ุงุฌุงุฏ ุฏฺฉููโูุง ููู ุงุตู ุจุง ุงุณุชูุงุฏู ุงุฒ ุชุงุจุน ุฌุฏุฏ
        menu = get_main_menu_keyboard()
        
        # ุชุนุฑู ุฏฺฉููโูุง ุงููุงู
        inline_buttons = InlineKeyboardMarkup(
            inline_keyboard=[
                [InlineKeyboardButton(text="๐จ ุงุฑุณุงู ุฏุนูุชูุงูู", callback_data="send_invitation")]
            ]
        )
        
        await callback.message.answer(
            f"ุณูุงู {callback.from_user.first_name}!\n\n๐ **ฺฉุฏ ุงุฎุชุตุงุต ุดูุง:** {unique_code}\n๐จ ุงู ฺฉุฏ ุฑุง ุจุฑุง ูพุงุฑุชูุฑุช ุจูุฑุณุช ุชุง ูุชุตู ุดูุฏ.\n\n{partner_status}\n\n"
            f"ุจุฑุง ุงุชุตุงู ุจู ูพุงุฑุชูุฑ ุฑู ุฏฺฉูู '/connect - ๐ ุงุชุตุงู ุจู ูพุงุฑุชูุฑ' ฺฉูฺฉ ฺฉูุฏ ุง ุฏุณุชูุฑ /connect ุฑุง ุงุฑุณุงู ฺฉูุฏ.",
            parse_mode="Markdown", reply_markup=menu
        )
        
        # ุงุฑุณุงู ูพุงู ุฏูู ุจุง ุฏฺฉูู ุดุดูโุง
        await callback.message.answer("ุจุฑุง ุงุฑุณุงู ุฏุนูุชูุงูู ุจู ูพุงุฑุชูุฑุ ุงุฒ ุฏฺฉูู ุฒุฑ ุงุณุชูุงุฏู ฺฉูุฏ:", reply_markup=inline_buttons)
    else:
        await callback.answer("โ ุดูุง ูููุฒ ุนุถู ฺฉุงูุงู ูุดุฏูโุงุฏ", show_alert=True)
        
        # ุงุฌุงุฏ ูุฌุฏุฏ ุฏฺฉูู ุจุฑุฑุณ ุนุถูุช
        subscription_keyboard = get_subscription_keyboard()
        await callback.message.edit_text(
            f"โ๏ธ ุจุฑุง ุงุณุชูุงุฏู ุงุฒ ุฑุจุงุชุ ุงุจุชุฏุง ุจุงุฏ ุฏุฑ ฺฉุงูุงู {CHANNEL_TITLE} ุนุถู ุดูุฏ.",
            reply_markup=subscription_keyboard
        )

@dp.message(Command("status"))
async def show_status_cmd(message: types.Message):
    """ ููุงุด ูุถุนุช ูุนู ฺฉุงุฑุจุฑ """
    # ุจุฑุฑุณ ุนุถูุช ฺฉุงุฑุจุฑ ุฏุฑ ฺฉุงูุงู
    if not await check_user_subscription(message):
        return
    
    user_id = message.from_user.id
    cursor.execute("SELECT unique_code, partner_id FROM users WHERE user_id=?", (user_id,))
    user_data = cursor.fetchone()
    
    if not user_data:
        await message.answer("โ๏ธ ุงุทูุงุนุงุช ุดูุง ุฏุฑ ุณุณุชู ุงูุช ูุดุฏ. ูุทูุงู ุฏูุจุงุฑู /start ุฑุง ุงุฑุณุงู ฺฉูุฏ.")
        return
    
    unique_code, partner_id = user_data
    
    # ุจุฑุฑุณ ุชุนุฏุงุฏ ฺุงูุด ูุง ูพุงุณุฎ ุฏุงุฏู ุดุฏู
    cursor.execute("SELECT COUNT(*) FROM questions WHERE user_id = ? AND answer IS NOT NULL", (user_id,))
    answered_challenges = cursor.fetchone()[0]
    
    partner_status = "โ ูฺ ูพุงุฑุชูุฑ ูุฏุงุฑุฏ."
    if partner_id:
        try:
            partner_info = await bot.get_chat(partner_id)
            partner_identifier = partner_info.username if partner_info.username else partner_info.first_name
            partner_status = f"โ ูุชุตู ุจู ูพุงุฑุชูุฑ: [{partner_identifier}](tg://user?id={partner_id})"
        except:
            partner_status = f"โ ูุชุตู ุจู ูพุงุฑุชูุฑ: [ฺฉุงุฑุจุฑ {partner_id}](tg://user?id={partner_id})"
    
    # ุงุฌุงุฏ ุฏฺฉูู ุดุดูโุง ุจุฑุง ุงุฑุณุงู ุฏุนูุชูุงูู
    inline_buttons = InlineKeyboardMarkup(
        inline_keyboard=[
            [InlineKeyboardButton(text="โ๏ธ ุงุฑุณุงู ุฏุนูุชูุงูู ุจู ูพุงุฑุชูุฑ", callback_data="send_invitation")]
        ]
    )
    
    await message.answer(
        f"๐ **ูุถุนุช ุดูุง:**\n\n"
        f"๐ ุขุฏ ุดูุง: `{user_id}`\n"
        f"๐ ฺฉุฏ ุงุฎุชุตุงุต: `{unique_code}`\n"
        f"๐ฏ ุชุนุฏุงุฏ ฺุงูุดโูุง ูพุงุณุฎ ุฏุงุฏู ุดุฏู: {answered_challenges}\n\n"
        f"{partner_status}",
        parse_mode="Markdown"
    )
    
    # ุงุฑุณุงู ูพุงู ุฏูู ุจุง ุฏฺฉูู ุดุดูโุง
    await message.answer("ุจุฑุง ุงุฑุณุงู ุฏุนูุชูุงูู ุจู ูพุงุฑุชูุฑุ ุงุฒ ุฏฺฉูู ุฒุฑ ุงุณุชูุงุฏู ฺฉูุฏ:", reply_markup=inline_buttons)

@dp.message(Command("reply"))
async def reply_to_user_cmd(message: types.Message):
    """ ูพุงุณุฎ ุจู ฺฉุงุฑุจุฑ ุงุฒ ุทุฑู ูพุดุชุจุงู """
    user_id = message.from_user.id
    
    # ููุท ุงุฏูู ูโุชูุงูุฏ ุงุฒ ุงู ุฏุณุชูุฑ ุงุณุชูุงุฏู ฺฉูุฏ
    if user_id != ADMIN_ID:
        await message.answer("โ๏ธ ุดูุง ูุฌุงุฒ ุจู ุงุณุชูุงุฏู ุงุฒ ุงู ุฏุณุชูุฑ ูุณุชุฏ.")
        return
    
    # ุจุฑุฑุณ ูุฑูุช ุตุญุญ ุฏุณุชูุฑ
    command_parts = message.text.split(maxsplit=2)
    if len(command_parts) < 3:
        await message.answer("โ๏ธ ูุฑูุช ุตุญุญ: /reply ID ูุชู ูพุงู")
        return
    
    try:
        target_user_id = int(command_parts[1])
        reply_text = command_parts[2]
        
        # ุจุฑุฑุณ ูุฌูุฏ ฺฉุงุฑุจุฑ ุฏุฑ ุฏุชุงุจุณ
        cursor.execute("SELECT user_id FROM users WHERE user_id = ?", (target_user_id,))
        if not cursor.fetchone():
            await message.answer(f"โ ฺฉุงุฑุจุฑ ุจุง ุดูุงุณู {target_user_id} ุงูุช ูุดุฏ.")
            return
        
        # ุงุฑุณุงู ูพุงู ุจู ฺฉุงุฑุจุฑ
        await bot.send_message(
            target_user_id,
            f"๐จโ๐ป ูพุงุณุฎ ุงุฒ ูพุดุชุจุงู:\n\n{reply_text}\n\n"
            f"ุจุฑุง ุงุฑุณุงู ูพุงู ุฌุฏุฏ ุจู ูพุดุชุจุงู ุงุฒ ุฏุณุชูุฑ /support ุงุณุชูุงุฏู ฺฉูุฏ."
        )
        
        await message.answer(f"โ ูพุงู ุจุง ููููุช ุจู ฺฉุงุฑุจุฑ {target_user_id} ุงุฑุณุงู ุดุฏ.")
        
    except ValueError:
        await message.answer("โ ุดูุงุณู ฺฉุงุฑุจุฑ ุจุงุฏ ฺฉ ุนุฏุฏ ุจุงุดุฏ.")
    except Exception as e:
        await message.answer(f"โ ุฎุทุง ุฏุฑ ุงุฑุณุงู ูพุงู: {str(e)}")

@dp.message(Command("support"))
async def support_cmd(message: types.Message):
    """ ุงุฑุชุจุงุท ุจุง ูพุดุชุจุงู """
    user_id = message.from_user.id
    
    # ุจุฑุฑุณ ุนุถูุช ฺฉุงุฑุจุฑ ุฏุฑ ฺฉุงูุงู
    is_subscribed = await check_subscription(user_id)
    if not is_subscribed:
        subscription_keyboard = get_subscription_keyboard()
        await message.answer(
            f"โ๏ธ ุจุฑุง ุงุณุชูุงุฏู ุงุฒ ุฑุจุงุชุ ุงุจุชุฏุง ุจุงุฏ ุฏุฑ ฺฉุงูุงู {CHANNEL_TITLE} ุนุถู ุดูุฏ.",
            reply_markup=subscription_keyboard
        )
        return
    
    # ุณุงุฎุช ฺฉุจูุฑุฏ ุจุฑุง ุงูุชุฎุงุจ ููุน ุฏุฑุฎูุงุณุช ูพุดุชุจุงู
    support_keyboard = InlineKeyboardMarkup(inline_keyboard=[
        [InlineKeyboardButton(text="๐ง ูุดฺฉู ูู", callback_data="support_technical")],
        [InlineKeyboardButton(text="โ ุณูุงู ู ุฑุงูููุง", callback_data="support_question")],
        [InlineKeyboardButton(text="๐ก ูพุดููุงุฏ", callback_data="support_suggestion")],
        [InlineKeyboardButton(text="๐ ุจุงุฒฺฏุดุช", callback_data="cancel_support")]
    ])
    
    await message.answer(
        "๐จโ๐ป ุจู ุจุฎุด ูพุดุชุจุงู ุฎูุด ุขูุฏุฏ!\n"
        "ูุทูุงู ููุน ุฏุฑุฎูุงุณุช ุฎูุฏ ุฑุง ุงูุชุฎุงุจ ฺฉูุฏ:",
        reply_markup=support_keyboard
    )

@dp.callback_query(lambda c: c.data.startswith("support_"))
async def support_type_callback(callback: types.CallbackQuery):
    """ ูพุฑุฏุงุฒุด ุงูุชุฎุงุจ ููุน ูพุดุชุจุงู """
    user_id = callback.from_user.id
    
    # ุฏุฑุงูุช ููุน ุฏุฑุฎูุงุณุช ูพุดุชุจุงู
    support_type = callback.data.split("_")[1]
    
    # ุฐุฎุฑู ูุถุนุช ฺฉุงุฑุจุฑ ุจุฑุง ุฏุฑุงูุช ูพุงู ูพุดุชุจุงู
    cursor.execute("UPDATE users SET waiting_for_support = ? WHERE user_id = ?", (support_type, user_id))
    conn.commit()
    
    support_types = {
        "technical": "๐ง ูุดฺฉู ูู",
        "question": "โ ุณูุงู ู ุฑุงูููุง",
        "suggestion": "๐ก ูพุดููุงุฏ"
    }
    
    await callback.message.edit_text(
        f"โ ุดูุง ุฏุฑ ุญุงู ุงุฑุณุงู {support_types[support_type]} ูุณุชุฏ.\n\n"
        "๐ ูุทูุงู ูพุงู ุฎูุฏ ุฑุง ุจุฑุง ุชู ูพุดุชุจุงู ุจููุณุฏ ู ุงุฑุณุงู ฺฉูุฏ.\n"
        "(ูโุชูุงูุฏ ูุชูุ ุนฺฉุณุ ูุฏู ุง ุตุฏุง ุงุฑุณุงู ฺฉูุฏ)"
    )
    
    # ุงุฌุงุฏ ุฏฺฉูู ูุบู ุฏุฑุฎูุงุณุช
    cancel_keyboard = InlineKeyboardMarkup(inline_keyboard=[
        [InlineKeyboardButton(text="๐ ูุบู ุฏุฑุฎูุงุณุช", callback_data="cancel_support")]
    ])
    
    await callback.message.answer("ุจุฑุง ูุบู ุฏุฑุฎูุงุณุชุ ุฑู ุฏฺฉูู ุฒุฑ ฺฉูฺฉ ฺฉูุฏ:", reply_markup=cancel_keyboard)

@dp.callback_query(lambda c: c.data == "cancel_support")
async def cancel_support_callback(callback: types.CallbackQuery):
    """ ูุบู ุฏุฑุฎูุงุณุช ูพุดุชุจุงู """
    user_id = callback.from_user.id
    
    # ูพุงฺฉ ฺฉุฑุฏู ูุถุนุช ุงูุชุธุงุฑ ุจุฑุง ูพุดุชุจุงู
    cursor.execute("UPDATE users SET waiting_for_support = NULL WHERE user_id = ?", (user_id,))
    conn.commit()
    
    await callback.message.edit_text("โ ุฏุฑุฎูุงุณุช ูพุดุชุจุงู ูุบู ุดุฏ.")

@dp.message()
async def process_message(message: types.Message):
    """ูพุฑุฏุงุฒุด ูพุงูโูุง ูุนููู (ุบุฑ ุฏุณุชูุฑ)"""
    user_id = message.from_user.id
    
    # ุจุฑุฑุณ ุขุง ูพุงู ฺฉ ุงุฒ ุฏฺฉููโูุง ููู ุงุณุช
    if message.text == "โญ๏ธ ุฏุฑุงูุช ฺุงูุด ุฌุฏุฏ":
        await challenge_button(message)
        return
    elif message.text == "๐ ูุถุนุช ูู":
        await status_button(message)
        return
    elif message.text == "๐ฅ ูพุงุฑุชูุฑ ูู":
        await partner_button(message)
        return
    elif message.text == "๐จ ูพุงู ุจู ูพุงุฑุชูุฑ":
        await message_button(message)
        return
    elif message.text == "๐ ูพุดุชุจุงู":
        await support_button(message)
        return
    elif message.text == "โ๏ธ ูพูู ูุฏุฑุช":
        await admin_panel_btn(message)
        return
    # ุจุฑุฑุณ ุขุง ูพุงู ุฏุณุชูุฑ broadcast ุงุณุช
    elif message.text and message.text.startswith("/broadcast "):
        await broadcast_cmd(message)
        return
    
    # ุจูโุฑูุฒุฑุณุงู ุงุทูุงุนุงุช ฺฉุงุฑุจุฑ ุจุฑุง ุขูุงุฑฺฏุฑ ุจูุชุฑ
    # ุงู ฺฉุงุฑ ุจู ูุง ฺฉูฺฉ ูโฺฉูุฏ ุงุทูุงุนุงุช ฺฉุงุฑุจุฑุงู ุฑุง ฺฉุงููโุชุฑ ุฏุงุดุชู ุจุงุดู
    username = message.from_user.username
    first_name = message.from_user.first_name
    last_name = message.from_user.last_name
    
    cursor.execute("""
        UPDATE users 
        SET username = ?, first_name = ?, last_name = ?
        WHERE user_id = ?
    """, (username, first_name, last_name, user_id))
    conn.commit()
    
    # ุจุฑุฑุณ ุนุถูุช ฺฉุงุฑุจุฑ ุฏุฑ ฺฉุงูุงู
    is_subscribed = await check_subscription(user_id)
    if not is_subscribed:
        subscription_keyboard = get_subscription_keyboard()
        await message.answer(
            f"โ๏ธ ุจุฑุง ุงุณุชูุงุฏู ุงุฒ ุฑุจุงุชุ ุงุจุชุฏุง ุจุงุฏ ุฏุฑ ฺฉุงูุงู {CHANNEL_TITLE} ุนุถู ุดูุฏ.",
            reply_markup=subscription_keyboard
        )
        return
    
    # ุจุฑุฑุณ ุญุณุงุจ ฺฉุงุฑุจุฑ
    cursor.execute("SELECT unique_code, partner_id, waiting_for_code, waiting_for_support FROM users WHERE user_id=?", (user_id,))
    user_data = cursor.fetchone()
    
    if not user_data:
        await message.answer("โ๏ธ ุงุทูุงุนุงุช ุดูุง ุฏุฑ ุณุณุชู ุงูุช ูุดุฏ. ูุทูุงู ุฏูุจุงุฑู /start ุฑุง ุงุฑุณุงู ฺฉูุฏ.")
        return
    
    unique_code, partner_id, waiting_for_code, waiting_for_support = user_data
    
    # ุจุฑุฑุณ ุขุง ฺฉุงุฑุจุฑ ุฏุฑ ุญุงู ุงุฑุณุงู ูพุงู ูพุดุชุจุงู ุงุณุช
    if waiting_for_support:
        # ุฏุฑุงูุช ุงุทูุงุนุงุช ฺฉุงุฑุจุฑ
        try:
            user_info = await bot.get_chat(user_id)
            user_name = user_info.username if user_info.username else user_info.first_name
        except Exception as e:
            print(f"ุฎุทุง ุฏุฑ ุฏุฑุงูุช ุงุทูุงุนุงุช ฺฉุงุฑุจุฑ ุจุฑุง ูพุดุชุจุงู: {e}")
            user_name = str(user_id)
            
        # ุชุนู ููุน ูพุงู ูพุดุชุจุงู
        support_types = {
            "technical": "๐ง ูุดฺฉู ูู",
            "question": "โ ุณูุงู ู ุฑุงูููุง",
            "suggestion": "๐ก ูพุดููุงุฏ"
        }
        
        support_type_text = support_types.get(waiting_for_support, "ุฏุฑุฎูุงุณุช ูพุดุชุจุงู")
        
        try:
            # ุงุฑุณุงู ูพุงู ฺฉุงุฑุจุฑ ุจู ูพุดุชุจุงู
            support_message = f"๐จ {support_type_text} ุงุฒ ฺฉุงุฑุจุฑ:\n\n"
            support_message += f"๐ค ฺฉุงุฑุจุฑ: {user_name} (ID: {user_id})\n\n"
            
            # ุชุดุฎุต ููุน ูพุงู (ูุชูุ ุนฺฉุณุ ูุฏู ู...)
            media_id = None
            media_type = None
            
            if message.text:
                support_message += f"๐ ูพุงู: {message.text}"
                
                await bot.send_message(SUPPORT_CHAT_ID, support_message)
                print(f"ูพุงู ูพุดุชุจุงู ูุชู ุจู {SUPPORT_CHAT_ID} ุงุฑุณุงู ุดุฏ")
            else:
                support_message += "๐ ูพุงู ุญุงู ูุฏุง ุงุณุช:"
                await bot.send_message(SUPPORT_CHAT_ID, support_message)
                print(f"ูพุงู ูพุดุชุจุงู ูุฏุง ุจู {SUPPORT_CHAT_ID} ุงุฑุณุงู ุดุฏ")
                
                if message.photo:
                    media_id = message.photo[-1].file_id
                    media_type = "photo"
                    caption = message.caption or ""
                    await bot.send_photo(SUPPORT_CHAT_ID, media_id, caption=f"๐ผ๏ธ ุชุตูุฑ ุงุฑุณุงู ุงุฒ ฺฉุงุฑุจุฑ\n{caption}")
                
                elif message.video:
                    media_id = message.video.file_id
                    media_type = "video"
                    caption = message.caption or ""
                    await bot.send_video(SUPPORT_CHAT_ID, media_id, caption=f"๐ฌ ูุฏู ุงุฑุณุงู ุงุฒ ฺฉุงุฑุจุฑ\n{caption}")
                
                elif message.voice:
                    media_id = message.voice.file_id
                    media_type = "voice"
                    await bot.send_voice(SUPPORT_CHAT_ID, media_id, caption=f"๐ค ุตุฏุง ุงุฑุณุงู ุงุฒ ฺฉุงุฑุจุฑ")
                
                elif message.video_note:
                    media_id = message.video_note.file_id
                    media_type = "video_note"
                    await bot.send_video_note(SUPPORT_CHAT_ID, media_id)
                    await bot.send_message(SUPPORT_CHAT_ID, f"๐ฅ ูุฏู ูุณุฌ ุงุฑุณุงู ุงุฒ ฺฉุงุฑุจุฑ {user_name}")
                
                elif message.sticker:
                    media_id = message.sticker.file_id
                    media_type = "sticker"
                    await bot.send_sticker(SUPPORT_CHAT_ID, media_id)
                    await bot.send_message(SUPPORT_CHAT_ID, f"๐ท๏ธ ุงุณุชฺฉุฑ ุงุฑุณุงู ุงุฒ ฺฉุงุฑุจุฑ {user_name}")
            
            # ุชุงุฏ ุฏุฑุงูุช ูพุงู ูพุดุชุจุงู ุจู ฺฉุงุฑุจุฑ
            await message.answer("โ ูพุงู ุดูุง ุจุง ููููุช ุจู ุชู ูพุดุชุจุงู ุงุฑุณุงู ุดุฏ.\nุฏุฑ ุงุณุฑุน ููุช ุจู ุดูุง ูพุงุณุฎ ุฎูุงูู ุฏุงุฏ.")
            
        except Exception as e:
            print(f"ุฎุทุง ุฏุฑ ุงุฑุณุงู ูพุงู ูพุดุชุจุงู: {e}")
            await message.answer("โ ุฎุทุง ุฏุฑ ุงุฑุณุงู ูพุงู ุจู ูพุดุชุจุงู ุฑุฎ ุฏุงุฏ. ูุทูุงู ุฏูุจุงุฑู ุชูุงุด ฺฉูุฏ.")
        
        # ูพุงฺฉ ฺฉุฑุฏู ูุถุนุช ุงูุชุธุงุฑ ุจุฑุง ูพุดุชุจุงู
        cursor.execute("UPDATE users SET waiting_for_support = NULL WHERE user_id = ?", (user_id,))
        conn.commit()
        
        return
    
    # ุจุฑุฑุณ ฺฉุฏ ูพุงุฑุชูุฑ
    if waiting_for_code:
        try:
            input_code = message.text.strip()
            
            # ุจุฑุฑุณ ุตุญุช ฺฉุฏ
            cursor.execute("SELECT user_id FROM users WHERE unique_code=?", (input_code,))
            result = cursor.fetchone()
            
            if not result:
                await message.answer("โ ฺฉุฏ ูุงูุนุชุจุฑ ุงุณุช. ูุทูุงู ฺฉ ฺฉุฏ ูุนุชุจุฑ ูุงุฑุฏ ฺฉูุฏ.")
                return
                
            partner_id = result[0]
            
            # ุจุฑุฑุณ ุงูฺฉู ุขุง ุฎูุฏ ฺฉุงุฑุจุฑ ุงุณุช
            if user_id == partner_id:
                await message.answer("โ ุดูุง ููโุชูุงูุฏ ุจู ุฎูุฏุชุงู ูุชุตู ุดูุฏ!")
                # ุจุฑูุฒุฑุณุงู ูุถุนุช ุงูุชุธุงุฑ ุจุฑุง ฺฉุฏ
                cursor.execute("UPDATE users SET waiting_for_code=0 WHERE user_id=?", (user_id,))
                conn.commit()
                return
            
            # ุจุฑุฑุณ ูุฌุฏุฏ ุงูฺฉู ุขุง ฺฉุงุฑุจุฑ ูููุฒ ุจู ฺฉุณ ูุชุตู ุงุณุช
            cursor.execute("SELECT partner_id FROM users WHERE user_id=?", (user_id,))
            user_data = cursor.fetchone()
            
            if user_data and user_data[0]:
                # ุงุฌุงุฏ ุฏฺฉูู ุจุฑุง ูุทุน ุงุฑุชุจุงุท
                keyboard = InlineKeyboardMarkup(
                    inline_keyboard=[
                        [InlineKeyboardButton(text="โ ูุทุน ุงุฑุชุจุงุท ุจุง ูพุงุฑุชูุฑ ูุนู", callback_data="disconnect_partner")]
                    ]
                )
                await message.answer("โ๏ธ ุดูุง ูููุฒ ุจู ูพุงุฑุชูุฑ ุฏฺฏุฑ ูุชุตู ูุณุชุฏ. ูุทูุงู ุงุจุชุฏุง ุงุฑุชุจุงุท ูุนู ุฎูุฏ ุฑุง ูุทุน ฺฉูุฏ.", reply_markup=keyboard)
                # ุจุฑูุฒุฑุณุงู ูุถุนุช ุงูุชุธุงุฑ ุจุฑุง ฺฉุฏ
                cursor.execute("UPDATE users SET waiting_for_code=0 WHERE user_id=?", (user_id,))
                conn.commit()
                return
            
            # ุจุฑุฑุณ ุงูฺฉู ุขุง ูพุงุฑุชูุฑ ูุจูุงู ุจู ฺฉุณ ูุชุตู ุงุณุช
            cursor.execute("SELECT partner_id FROM users WHERE user_id=?", (partner_id,))
            partner_data = cursor.fetchone()
            
            if partner_data and partner_data[0]:
                await message.answer("โ ฺฉุงุฑุจุฑ ููุฑุฏ ูุธุฑ ูุจูุงู ุจู ูพุงุฑุชูุฑ ุฏฺฏุฑ ูุชุตู ุดุฏู ุงุณุช. ูุทูุงู ุงุฒ ุงู ุจุฎูุงูุฏ ุงุจุชุฏุง ุงุฑุชุจุงุท ูุนู ุฎูุฏ ุฑุง ูุทุน ฺฉูุฏ.")
                # ุจุฑูุฒุฑุณุงู ูุถุนุช ุงูุชุธุงุฑ ุจุฑุง ฺฉุฏ
                cursor.execute("UPDATE users SET waiting_for_code=0 WHERE user_id=?", (user_id,))
                conn.commit()
                return
                
            # ุจุฑูุฒุฑุณุงู ูุถุนุช ุงูุชุธุงุฑ ุจุฑุง ฺฉุฏ ูุจู ุงุฒ ุงุชุตุงู
            cursor.execute("UPDATE users SET waiting_for_code=0 WHERE user_id=?", (user_id,))
            conn.commit()
            
            # ุงุชุตุงู ุจู ูพุงุฑุชูุฑ
            await process_partner_connection(message, partner_id)
            
        except Exception as e:
            # ุจุฑูุฒุฑุณุงู ูุถุนุช ุงูุชุธุงุฑ ุจุฑุง ฺฉุฏ ุฏุฑ ุตูุฑุช ุฎุทุง
            cursor.execute("UPDATE users SET waiting_for_code=0 WHERE user_id=?", (user_id,))
            conn.commit()
            
            await message.answer("โ ุฎุทุง ุฏุฑ ูพุฑุฏุงุฒุด ฺฉุฏ. ูุทูุงู ูุฌุฏุฏุงู ุชูุงุด ฺฉูุฏ.")
        
        return
    
    # ุจุฑุฑุณ ูุชู ุฏฺฉููโูุง
    if message.text:
        if message.text.startswith("/connect") or "ุงุชุตุงู ุจู ูพุงุฑุชูุฑ" in message.text:
            await connect_partner_cmd(message)
            return
        elif message.text.startswith("/manage") or "ูุฏุฑุช ูพุงุฑุชูุฑ" in message.text:
            await manage_partner_cmd(message)
            return
        elif message.text.startswith("/status") or "ูุดุงูุฏู ูุถุนุช" in message.text:
            await show_status_cmd(message)
            return
        elif message.text.startswith("/support") or "ูพุดุชุจุงู" in message.text:
            await support_cmd(message)
            return
        elif message.text.startswith("/challenge") or "ุฏุฑุงูุช ฺุงูุด ุฌุฏุฏ" in message.text:
            await new_challenge_cmd(message)
            return
    
    # ุจุฑุฑุณ ุงูฺฉู ุขุง ฺฉุงุฑุจุฑ ูููุฒ ูพุงุฑุชูุฑ ูุฏุงุฑุฏ
    if not partner_id:
        await message.answer("โ ุดูุง ูููุฒ ุจู ูพุงุฑุชูุฑ ูุชุตู ูุดุฏูโุงุฏ. ูุทูุงู ุงุจุชุฏุง ุจุง ุงุณุชูุงุฏู ุงุฒ ุฏุณุชูุฑ /connect ุง ุฏฺฉูู ูุฑุจูุทู ุจู ฺฉ ูพุงุฑุชูุฑ ูุชุตู ุดูุฏ.")
        return
    
    # ุจุฑุฑุณ ุงูฺฉู ุขุง ุงู ูพุงู ูพุงุณุฎ ุจู ุณูุงู ุงุณุช ุง ฺุช ุนุงุฏ
    cursor.execute("SELECT id, question FROM questions WHERE user_id = ? AND partner_id = ? AND answer IS NULL", (user_id, partner_id))
    question_data = cursor.fetchone()
    
    if question_data:
        question_id, question_text = question_data
        answer_text = None
        media_type = None
        media_id = None
        
        # ุงุณุชุฎุฑุงุฌ ูุชู ูพุงุณุฎ ุงุฒ ุงููุงุน ูุฎุชูู ูพุงู
        if message.text:
            answer_text = message.text
        elif message.caption:
            answer_text = message.caption
        else:
            answer_text = "ุจุฏูู ูุชู"
            
        if message.photo:
            media_type = "photo"
            media_id = message.photo[-1].file_id
        elif message.video:
            media_type = "video"
            media_id = message.video.file_id
        elif message.voice:
            media_type = "voice"
            media_id = message.voice.file_id
        elif message.video_note:
            media_type = "video_note"
            media_id = message.video_note.file_id
        
        # ุฐุฎุฑู ูพุงุณุฎ ุฏุฑ ุฏุชุงุจุณ
        try:
            cursor.execute("UPDATE questions SET answer = ? WHERE id = ?", (answer_text, question_id))
            conn.commit()
            
            await message.answer("โ ูพุงุณุฎ ุดูุง ุจู ฺุงูุด ุฐุฎุฑู ุดุฏ.")
            
            # ุจุฑุฑุณ ุขุง ูพุงุฑุชูุฑ ูู ูพุงุณุฎ ุฏุงุฏู ุงุณุช
            cursor.execute("SELECT answer FROM questions WHERE user_id = ? AND partner_id = ? AND question = ?", 
                           (partner_id, user_id, question_text))
            partner_answer = cursor.fetchone()
            
            # ุชูู ุงุทูุงุนุงุช ุจุฑุง ุงุฏูู
            try:
                user_info = await bot.get_chat(user_id)
                user_identifier = user_info.username if user_info.username else user_info.first_name
            except:
                user_identifier = str(user_id)
            
            admin_notification = f"๐ ฺฉุงุฑุจุฑ {user_identifier} ุจู ฺุงูุด ูพุงุณุฎ ุฏุงุฏ:\n"
            admin_notification += f"ุณูุงู: {question_text}\n"
            admin_notification += f"ูพุงุณุฎ: {answer_text or 'ุจุฏูู ูุชู'}"
            
            # ุงุฑุณุงู ุงุทูุงุนุงุช ุจู ุงุฏูู
            await bot.send_message(SUPPORT_CHAT_ID, admin_notification)
            
            # ุงุฑุณุงู ูุฏุง ุจู ุงุฏูู
            if media_type and media_id:
                try:
                    if media_type == "photo":
                        await bot.send_photo(SUPPORT_CHAT_ID, media_id, caption=f"๐ท ุชุตูุฑ ูพุงุณุฎ ฺฉุงุฑุจุฑ {user_identifier}")
                    elif media_type == "video":
                        await bot.send_video(SUPPORT_CHAT_ID, media_id, caption=f"๐ฌ ูุฏู ูพุงุณุฎ ฺฉุงุฑุจุฑ {user_identifier}")
                    elif media_type == "voice":
                        await bot.send_voice(SUPPORT_CHAT_ID, media_id, caption=f"๐ค ุตุฏุง ูพุงุณุฎ ฺฉุงุฑุจุฑ {user_identifier}")
                    elif media_type == "video_note":
                        await bot.send_video_note(SUPPORT_CHAT_ID, media_id)
                except Exception as e:
                    print(f"ุฎุทุง ุฏุฑ ุงุฑุณุงู ูุฏุง ุจู ุงุฏูู: {e}")
            
            if partner_answer and partner_answer[0]:  # ุงฺฏุฑ ูพุงุฑุชูุฑ ูพุงุณุฎ ุฏุงุฏู ุจุงุดุฏ
                # ุงุฑุณุงู ูพุงุณุฎ ูพุงุฑุชูุฑ ุจู ฺฉุงุฑุจุฑ
                await bot.send_message(user_id, 
                                      f"๐ฏ ูุฑ ุฏู ููุฑ ุจู ฺุงูุด ูพุงุณุฎ ุฏุงุฏุฏ! ูพุงุณุฎ ูพุงุฑุชูุฑ ุดูุง:\n\n"
                                      f"โ ุณูุงู: {question_text}\n"
                                      f"๐ฌ ูพุงุณุฎ ูพุงุฑุชูุฑ: {partner_answer[0]}")
                
                # ุงุฑุณุงู ูพุงุณุฎ ฺฉุงุฑุจุฑ ุจู ูพุงุฑุชูุฑ
                await bot.send_message(partner_id, 
                                     f"๐ฏ ูุฑ ุฏู ููุฑ ุจู ฺุงูุด ูพุงุณุฎ ุฏุงุฏุฏ! ูพุงุณุฎ ูพุงุฑุชูุฑ ุดูุง:\n\n"
                                     f"โ ุณูุงู: {question_text}\n"
                                     f"๐ฌ ูพุงุณุฎ ูพุงุฑุชูุฑ: {answer_text}")
                
                # ุงุฑุณุงู ูุฏุง (ุฏุฑ ุตูุฑุช ูุฌูุฏ) ุจู ูพุงุฑุชูุฑ
                if media_type and media_id:
                    try:
                        if media_type == "photo":
                            await bot.send_photo(partner_id, media_id, caption="๐ท ุชุตูุฑ ูพุงุณุฎ ูพุงุฑุชูุฑ ุดูุง")
                        elif media_type == "video":
                            await bot.send_video(partner_id, media_id, caption="๐ฌ ูุฏู ูพุงุณุฎ ูพุงุฑุชูุฑ ุดูุง")
                        elif media_type == "voice":
                            await bot.send_voice(partner_id, media_id, caption="๐ค ุตุฏุง ูพุงุณุฎ ูพุงุฑุชูุฑ ุดูุง")
                        elif media_type == "video_note":
                            await bot.send_video_note(partner_id, media_id)
                    except Exception as e:
                        print(f"ุฎุทุง ุฏุฑ ุงุฑุณุงู ูุฏุง ุจู ูพุงุฑุชูุฑ: {e}")
                
                # ุจุฑุฑุณ ููู ุณูุงูุงุช ุจโูพุงุณุฎ
                cursor.execute("SELECT COUNT(*) FROM questions WHERE (user_id = ? OR user_id = ?) AND answer IS NULL", 
                              (user_id, partner_id))
                unanswered_count = cursor.fetchone()[0]
                
                # ุงุฑุณุงู ุณูุงู ุฌุฏุฏ ุงฺฏุฑ ููู ุณูุงูุงุช ูพุงุณุฎ ุฏุงุฏู ุดุฏูโุงูุฏ
                if unanswered_count == 0:
                    await send_question(user_id, partner_id)
            else:
                # ุงุทูุงุน ุจู ูพุงุฑุชูุฑ ฺฉู ฺฉุงุฑุจุฑ ูพุงุณุฎ ุฏุงุฏู ุงุณุช
                await bot.send_message(partner_id, f"๐ก ูพุงุฑุชูุฑ ุดูุง ุจู ฺุงูุด ุงุฎุฑ ูพุงุณุฎ ุฏุงุฏู ุงุณุช. ููุชุธุฑ ูพุงุณุฎ ุดูุง ูุณุชู!")
            
            # ุชููู ูพุฑุฏุงุฒุด ุจุดุชุฑ ูพุงูุ ฺูู ุงู ฺฉ ูพุงุณุฎ ุจู ฺุงูุด ุจูุฏ
            return
        
        except Exception as e:
            print(f"ุฎุทุง ุฏุฑ ุฐุฎุฑู ูพุงุณุฎ: {e}")
            await message.answer("โ ุฎุทุง ุฏุฑ ุฐุฎุฑู ูพุงุณุฎ ุฑุฎ ุฏุงุฏ. ูุทูุงู ุฏูุจุงุฑู ุชูุงุด ฺฉูุฏ.")
            return
    
    # ูพุฑุฏุงุฒุด ูพุงู ุนุงุฏ
    message_text = None
    media_type = None
    media_id = None
    
    if message.text:
        message_text = message.text
    elif message.caption:
        message_text = message.caption
    
    if message.photo:
        media_type = "photo"
        media_id = message.photo[-1].file_id
    elif message.video:
        media_type = "video"
        media_id = message.video.file_id
    elif message.voice:
        media_type = "voice"
        media_id = message.voice.file_id
    elif message.video_note:
        media_type = "video_note"
        media_id = message.video_note.file_id
    elif message.sticker:
        media_type = "sticker"
        media_id = message.sticker.file_id
    
    # ุฐุฎุฑู ูพุงู ุฏุฑ ุฏุชุงุจุณ
    cursor.execute(
        "INSERT INTO messages (sender_id, receiver_id, message, media_type, media_id) VALUES (?, ?, ?, ?, ?)",
        (user_id, partner_id, message_text, media_type, media_id)
    )
    conn.commit()
    
    # ุงุฑุณุงู ูพุงู ุจู ูพุงุฑุชูุฑ
    if message_text:
        await bot.send_message(partner_id, f"๐ฌ **ูพุงู ุฌุฏุฏ ุงุฒ ูพุงุฑุชูุฑุช:**\n{message_text}")
    
    # ุงุฑุณุงู ูุฏุง ุจู ูพุงุฑุชูุฑ
    if media_type and media_id:
        caption = "๐ฉ ูุฏุง ุงุฒ ุทุฑู ูพุงุฑุชูุฑ ุดูุง"
        if message_text:
            caption = message_text
            
        if media_type == "photo":
            await bot.send_photo(partner_id, media_id, caption=caption)
        elif media_type == "video":
            await bot.send_video(partner_id, media_id, caption=caption)
        elif media_type == "voice":
            await bot.send_voice(partner_id, media_id, caption=caption)
        elif media_type == "video_note":
            await bot.send_video_note(partner_id, media_id)
        elif media_type == "sticker":
            await bot.send_sticker(partner_id, media_id)
    
    # ุงุฑุณุงู ฺฉูพ ูพุงู ุจู ุงุฏูู
    admin_message = f"๐ ูพุงู ุงุฒ ฺฉุงุฑุจุฑ {user_id} ุจู {partner_id}:"
    if message_text:
        admin_message += f"\n{message_text}"
    else:
        admin_message += f"\n[{media_type}]"
    
    await bot.send_message(SUPPORT_CHAT_ID, admin_message)
    
    # ุงุฑุณุงู ูุฏุง ุจู ุงุฏูู
    if media_type and media_id:
        admin_media_caption = f"๐ ูุฏุง ุงุฒ ฺฉุงุฑุจุฑ {user_id} ุจู ฺฉุงุฑุจุฑ {partner_id}"
        if message_text:
            admin_media_caption += f"\nูพุงู: {message_text}"
            
        if media_type == "photo":
            await bot.send_photo(SUPPORT_CHAT_ID, media_id, caption=admin_media_caption)
        elif media_type == "video":
            await bot.send_video(SUPPORT_CHAT_ID, media_id, caption=admin_media_caption)
        elif media_type == "voice":
            await bot.send_voice(SUPPORT_CHAT_ID, media_id, caption=admin_media_caption)
        elif media_type == "video_note":
            await bot.send_message(SUPPORT_CHAT_ID, f"๐ ฺฉุงุฑุจุฑ {user_id} ฺฉ ูุฏู ูุณุฌ ุจุฑุง ฺฉุงุฑุจุฑ {partner_id} ุงุฑุณุงู ฺฉุฑุฏ")
            await bot.send_video_note(SUPPORT_CHAT_ID, media_id)
        elif media_type == "sticker":
            await bot.send_message(SUPPORT_CHAT_ID, f"๐ ฺฉุงุฑุจุฑ {user_id} ฺฉ ุงุณุชฺฉุฑ ุจุฑุง ฺฉุงุฑุจุฑ {partner_id} ุงุฑุณุงู ฺฉุฑุฏ")
            await bot.send_sticker(SUPPORT_CHAT_ID, media_id)

async def process_partner_connection(message: types.Message, partner_id: int):
    """ ูพุฑุฏุงุฒุด ุงุชุตุงู ุจู ูพุงุฑุชูุฑ """
    user_id = message.from_user.id
    
    try:
        # ุฏุฑุงูุช ุงุทูุงุนุงุช ฺฉุงุฑุจุฑุงู
        cursor.execute("SELECT unique_code FROM users WHERE user_id=?", (user_id,))
        user_code = cursor.fetchone()[0]
        
        # ุจุฑุฑุณ ฺุงูุดโูุง ุจโูพุงุณุฎ ูุจู ุจู ุงู ุฏู ฺฉุงุฑุจุฑ
        cursor.execute("SELECT id, question FROM questions WHERE user_id = ? AND partner_id = ? AND answer IS NULL", (user_id, partner_id))
        user_unanswered = cursor.fetchone()
        
        cursor.execute("SELECT id, question FROM questions WHERE user_id = ? AND partner_id = ? AND answer IS NULL", (partner_id, user_id))
        partner_unanswered = cursor.fetchone()
        
        # ุญุฐู ฺุงูุดโูุง ุจโูพุงุณุฎ ูุจู ุจุง ูพุงุฑุชูุฑูุง ุฏฺฏุฑ (ุจุฑุง ูุฑ ุฏู ฺฉุงุฑุจุฑ)
        # ุจุฑุง ฺฉุงุฑุจุฑ ุงุตู
        cursor.execute("DELETE FROM questions WHERE user_id = ? AND partner_id != ? AND answer IS NULL", (user_id, partner_id))
        # ุจุฑุง ูพุงุฑุชูุฑ ุฌุฏุฏ
        cursor.execute("DELETE FROM questions WHERE user_id = ? AND partner_id != ? AND answer IS NULL", (partner_id, user_id))
        
        # ุงุชุตุงู ฺฉุงุฑุจุฑุงู ุจู ฺฉุฏฺฏุฑ
        cursor.execute("UPDATE users SET partner_id=? WHERE user_id=?", (partner_id, user_id))
        cursor.execute("UPDATE users SET partner_id=? WHERE user_id=?", (user_id, partner_id))
        conn.commit()
        
        # ุงุฑุณุงู ูพุงู ุชุงุฏ ุจู ูุฑ ุฏู ฺฉุงุฑุจุฑ
        try:
            # ุงุทูุงุนุงุช ุจุฑุง ููุงุด
            user_info = await bot.get_chat(user_id)
            partner_info = await bot.get_chat(partner_id)
            
            user_identifier = user_info.username if user_info.username else user_info.first_name
            partner_identifier = partner_info.username if partner_info.username else partner_info.first_name
            
            # ุงุฑุณุงู ูพุงู ุจู ฺฉุงุฑุจุฑุงู
            await message.answer(f"โ ุดูุง ุจุง ููููุช ุจู {partner_identifier} ูุชุตู ุดุฏุฏ!\n\nุงฺฉููู ูโุชูุงูุฏ ูพุงู ุงุฑุณุงู ฺฉูุฏ ู ุจู ุตูุฑุช ุฑูุฒุงูู ฺุงูุดโูุง ูุดุชุฑฺฉ ุฏุฑุงูุช ฺฉูุฏ.")
            await bot.send_message(partner_id, f"โ {user_identifier} ุจุง ุดูุง ูุชุตู ุดุฏ!\n\nุงฺฉููู ูโุชูุงูุฏ ูพุงู ุงุฑุณุงู ฺฉูุฏ ู ุจู ุตูุฑุช ุฑูุฒุงูู ฺุงูุดโูุง ูุดุชุฑฺฉ ุฏุฑุงูุช ฺฉูุฏ.")
            
            # ุงุทูุงุน ุจู ุงุฏูู
            await bot.send_message(
                SUPPORT_CHAT_ID, 
                f"๐ ุงุชุตุงู ุฌุฏุฏ:\n{user_identifier} ุจู {partner_identifier} ูุชุตู ุดุฏ."
            )
            
            # ูฺฉุซ ฺฉูุชุงู
            await asyncio.sleep(2)
            
            # ุจุฑุฑุณ ุขุง ุงู ุฏู ฺฉุงุฑุจุฑ ูุจูุงู ฺุงูุด ุจโูพุงุณุฎ ุฏุงุดุชูโุงูุฏ
            has_unanswered_challenges = False
            
            if user_unanswered:
                has_unanswered_challenges = True
                await bot.send_message(user_id, f"โ๏ธ ุงุฏุขูุฑ: ุดูุง ูููุฒ ุจู ุงู ฺุงูุด ูุจู ูพุงุณุฎ ูุฏุงุฏูโุงุฏ:\n\n{user_unanswered[1]}\n\nโ๏ธ ูุทูุงู ูพุงุณุฎ ุฎูุฏ ุฑุง ุงุฑุณุงู ฺฉูุฏ.")
            
            if partner_unanswered:
                has_unanswered_challenges = True
                await bot.send_message(partner_id, f"โ๏ธ ุงุฏุขูุฑ: ุดูุง ูููุฒ ุจู ุงู ฺุงูุด ูุจู ูพุงุณุฎ ูุฏุงุฏูโุงุฏ:\n\n{partner_unanswered[1]}\n\nโ๏ธ ูุทูุงู ูพุงุณุฎ ุฎูุฏ ุฑุง ุงุฑุณุงู ฺฉูุฏ.")
            
            # ููุดู ฺฉ ฺุงูุด ุฌุฏุฏ ุงุฑุณุงู ูโฺฉูู ูฺฏุฑ ุงูฺฉู ฺุงูุด ุจโูพุงุณุฎ ุงุฒ ูุจู ูุฌูุฏ ุฏุงุดุชู ุจุงุดุฏ
            if not has_unanswered_challenges:
                # ุงุฑุณุงู ุงููู ุณูุงู ฺุงูุด - ุจุง ูพุงุฑุงูุชุฑ force=True ุจุฑุง ูุงุฏุฏู ฺฏุฑูุชู ูุญุฏูุฏุช ุฒูุงู
                await send_question(user_id, partner_id, force=True)
            
            return True
            
        except Exception as e:
            print(f"Error sending connection messages: {e}")
            # ุจุง ูุฌูุฏ ุฎุทุง ุฏุฑ ุงุฑุณุงู ูพุงูุ ุงุชุตุงู ุงูุฌุงู ุดุฏู ุงุณุช
            # ุจูุงุจุฑุงู ูพุงู ุฎุทุง ูุดุงู ููโุฏูู
            return True
            
    except Exception as e:
        print(f"Error in process_partner_connection: {e}")
        # ููุท ุงฺฏุฑ ุฎุทุง ุงุตู ุฏุฑ ุงุชุตุงู ุฑุฎ ุฏุงุฏู ุจุงุดุฏุ ูพุงู ุฎุทุง ููุงุด ูโุฏูู
        await message.answer("โ ุฎุทุง ุฏุฑ ุงุชุตุงู ุจู ูพุงุฑุชูุฑ ุฑุฎ ุฏุงุฏ. ูุทูุงู ุฏูุจุงุฑู ุชูุงุด ฺฉูุฏ.")
        return False

@dp.callback_query(lambda c: c.data == "send_invitation")
async def send_invitation_callback(callback_query: types.CallbackQuery):
    """ ุงุฑุณุงู ุฏุนูุชูุงูู ุจู ูพุงุฑุชูุฑ """
    user_id = callback_query.from_user.id
    
    # ุจุฑุฑุณ ุงุทูุงุนุงุช ฺฉุงุฑุจุฑ
    cursor.execute("SELECT unique_code FROM users WHERE user_id=?", (user_id,))
    result = cursor.fetchone()
    
    if not result:
        await callback_query.answer("โ๏ธ ุงุทูุงุนุงุช ุดูุง ุงูุช ูุดุฏ. ูุทูุงู ุฏูุจุงุฑู /start ุฑุง ุงุฑุณุงู ฺฉูุฏ.", show_alert=True)
        return
    
    unique_code = result[0]
    user_name = callback_query.from_user.first_name
    
    # ูุชู ุฏุนูุชูุงูู
    invitation_text = f"""๐น ุณูุงู ุนุฒุฒู!

ูู ุฏุฑ ุฑุจุงุช ฺุงูุด ุนุงุดูุงูู @challeshhamdelibot ุซุจุชโูุงู ฺฉุฑุฏู ู ูโุฎูุงู ุจุง ุชู ุจู ฺุงูุดโูุง ูุฌุงูโุงูฺฏุฒ ูพุงุณุฎ ุจุฏู.

ุจุง ุงู ุฑุจุงุช ูโุชููู ุจู ุณูุงูุงุช ุฌุงูุจ ุฏุฑ ููุฑุฏ ุฑุงุจุทูโููู ูพุงุณุฎ ุจุฏู ู ุจุดุชุฑ ููุฏฺฏู ุฑู ุจุดูุงุณู.

โฅ๏ธ ุจุฑุง ุงุชุตุงู ุจู ููุ ฺฉุงูู ุงู ูุฑุงุญู ุฑู ุงูุฌุงู ุจุฏ:
1๏ธโฃ ูุงุฑุฏ ุฑุจุงุช ุดู: @challeshhamdelibot
2๏ธโฃ ุฏุณุชูุฑ /start ุฑู ุจุฒู
3๏ธโฃ ุนุถู ฺฉุงูุงู ุฑุจุงุช ุดู
4๏ธโฃ ุฑู ุฏฺฉูู "๐ ุงุชุตุงู ุจู ูพุงุฑุชูุฑ" ุจุฒู
5๏ธโฃ ุงู ฺฉุฏ ุฑู ูุงุฑุฏ ฺฉู: {unique_code}

ููุชุธุฑุชู... ๐

ุจุง ุนุดูุ {user_name}"""

    # ุงุฑุณุงู ูพุงู ุฏุนูุชูุงูู ุจู ฺฉุงุฑุจุฑ
    await callback_query.message.answer(invitation_text)
    await callback_query.answer("โ ูุชู ุฏุนูุชูุงูู ุงุฌุงุฏ ุดุฏ. ุขู ุฑุง ุจุฑุง ูพุงุฑุชูุฑ ุฎูุฏ ุงุฑุณุงู ฺฉูุฏ.", show_alert=True)

# ุงุฌุงุฏ ุฏฺฉูู ุจุฑุง ุฏุฑุฎูุงุณุช ฺุงูุด ุฌุฏุฏ
def get_main_menu_keyboard():
    """ ุงุฌุงุฏ ฺฉุจูุฑุฏ ููู ุงุตู """
    menu = ReplyKeyboardMarkup(
        keyboard=[
            [KeyboardButton(text="โญ๏ธ ุฏุฑุงูุช ฺุงูุด ุฌุฏุฏ")],
            [KeyboardButton(text="๐ ูุถุนุช ูู"), KeyboardButton(text="๐ฅ ูพุงุฑุชูุฑ ูู")],
            [KeyboardButton(text="๐จ ูพุงู ุจู ูพุงุฑุชูุฑ"), KeyboardButton(text="๐ ูพุดุชุจุงู")]
        ],
        resize_keyboard=True
    )
    
    return menu

def get_admin_menu_keyboard():
    """ ุงุฌุงุฏ ฺฉุจูุฑุฏ ููู ุงุตู ุจุฑุง ุงุฏูู """
    menu = ReplyKeyboardMarkup(
        keyboard=[
            [KeyboardButton(text="โญ๏ธ ุฏุฑุงูุช ฺุงูุด ุฌุฏุฏ")],
            [KeyboardButton(text="๐ ูุถุนุช ูู"), KeyboardButton(text="๐ฅ ูพุงุฑุชูุฑ ูู")],
            [KeyboardButton(text="๐จ ูพุงู ุจู ูพุงุฑุชูุฑ"), KeyboardButton(text="๐ ูพุดุชุจุงู")],
            [KeyboardButton(text="โ๏ธ ูพูู ูุฏุฑุช")]
        ],
        resize_keyboard=True
    )
    
    return menu

# ุงูุฒูุฏู ููุฏูุฑ ุฌุฏุฏ ุจุฑุง ุฏุฑุฎูุงุณุช ฺุงูุด ุฌุฏุฏ
@dp.message(Command("challenge"))
async def new_challenge_cmd(message: types.Message):
    """ ุฏุฑุฎูุงุณุช ุฏุฑุงูุช ฺุงูุด ุฌุฏุฏ """
    user_id = message.from_user.id
    
    # ุจุฑุฑุณ ุนุถูุช ฺฉุงุฑุจุฑ ุฏุฑ ฺฉุงูุงู
    if not await check_user_subscription(message):
        return
    
    # ุจุฑุฑุณ ูุฌูุฏ ูพุงุฑุชูุฑ
    cursor.execute("SELECT partner_id FROM users WHERE user_id=?", (user_id,))
    partner = cursor.fetchone()
    
    if not partner or not partner[0]:
        await message.answer("โ๏ธ ุดูุง ูููุฒ ุจู ูพุงุฑุชูุฑ ูุชุตู ูุดุฏูโุงุฏ. ูุทูุงู ุงุจุชุฏุง ุจุง ุงุณุชูุงุฏู ุงุฒ ุฏุณุชูุฑ /connect ุง ุฏฺฉูู ูุฑุจูุทู ุจู ฺฉ ูพุงุฑุชูุฑ ูุชุตู ุดูุฏ.")
        return
    
    partner_id = partner[0]
    
    # ุงุฑุณุงู ฺุงูุด ุฌุฏุฏ ุจุง ุงุณุชูุงุฏู ุงุฒ ูพุงุฑุงูุชุฑ force=True
    result = await send_question(user_id, partner_id, force=True)
    
    if result:
        await message.answer("โ ฺุงูุด ุฌุฏุฏ ุจุฑุง ุดูุง ู ูพุงุฑุชูุฑ ุดูุง ุงุฑุณุงู ุดุฏ!")
    else:
        await message.answer("โ๏ธ ุงูฺฉุงู ุงุฑุณุงู ฺุงูุด ุฌุฏุฏ ุฏุฑ ุญุงู ุญุงุถุฑ ูุฌูุฏ ูุฏุงุฑุฏ. ูุทูุงู ุงุจุชุฏุง ุจู ฺุงูุด ูุจู ูพุงุณุฎ ุฏูุฏ.")

async def main():
    # ุจูโุฑูุฒุฑุณุงู timestamp ุจุฑุง ุชูุงู ุณูุงูุงุช ุจโูพุงุณุฎ ูุนู
    current_time = int(time.time())
    cursor.execute("UPDATE questions SET timestamp = ? WHERE answer IS NULL AND (timestamp IS NULL OR timestamp = 0)", (current_time,))
    conn.commit()
    print("โ timestamp ููู ุณูุงูุงุช ุจโูพุงุณุฎ ุจูโุฑูุฒุฑุณุงู ุดุฏ.")
    
    # ุดุฑูุน ุชุณฺฉ ุงุฑุณุงู ุณูุงูุงุช ุฒูุงูโุจูุฏ ุดุฏู
    asyncio.create_task(scheduled_questions())
    
    # ุดุฑูุน ุชุณฺฉ ุงุฑุณุงู ุงุฏุขูุฑโูุง
    asyncio.create_task(send_reminders())
    
    # ุดุฑูุน ูพุงูุณูฺฏ ุฑุจุงุช
    await dp.start_polling(bot)

@dp.message(Command("broadcast"))
async def broadcast_cmd(message: types.Message):
    """ุงุฑุณุงู ูพุงู ฺฏุฑูู ุจู ุชูุงู ฺฉุงุฑุจุฑุงู ุฑุจุงุช (ููุท ุจุฑุง ุงุฏูู)"""
    user_id = message.from_user.id
    
    # ุจุฑุฑุณ ุฏุณุชุฑุณ ุงุฏูู
    if user_id != ADMIN_ID:
        await message.answer("โ๏ธ ุดูุง ุฏุณุชุฑุณ ุจู ุงู ุจุฎุด ุฑุง ูุฏุงุฑุฏ.")
        return
    
    # ุจุฑุฑุณ ูุชู ูพุงู
    command_parts = message.text.split(maxsplit=1)
    if len(command_parts) < 2:
        await message.answer("โ๏ธ ูุทูุง ูพุงู ุฎูุฏ ุฑุง ุจุนุฏ ุงุฒ ุฏุณุชูุฑ /broadcast ูุงุฑุฏ ฺฉูุฏ.")
        return
    
    broadcast_message = command_parts[1]
    
    # ุฏุฑุงูุช ูุณุช ุชูุงู ฺฉุงุฑุจุฑุงู
    cursor.execute("SELECT user_id FROM users")
    all_users = cursor.fetchall()
    
    success_count = 0
    fail_count = 0
    
    await message.answer("๐ ุฏุฑ ุญุงู ุงุฑุณุงู ูพุงู ฺฏุฑูู...")
    
    # ุงุฑุณุงู ูพุงู ุจู ุชูุงู ฺฉุงุฑุจุฑุงู
    for user in all_users:
        try:
            await bot.send_message(user[0], f"๐ข ูพุงู ุงุฒ ุทุฑู ูุฏุฑุช ุฑุจุงุช:\n\n{broadcast_message}")
            success_count += 1
            # ฺฉู ุชุงุฎุฑ ุจุฑุง ุฌููฺฏุฑ ุงุฒ ูุญุฏูุฏุชโูุง ุชูฺฏุฑุงู
            await asyncio.sleep(0.05)
        except Exception:
            fail_count += 1
    
    # ฺฏุฒุงุฑุด ูุชุฌู ุจู ุงุฏูู
    await message.answer(
        f"โ ฺฏุฒุงุฑุด ุงุฑุณุงู ูพุงู ฺฏุฑูู:\n"
        f"๐จ ุงุฑุณุงู ูููู: {success_count}\n"
        f"โ ุงุฑุณุงู ูุงูููู: {fail_count}\n"
        f"๐ ูุฌููุน: {len(all_users)}"
    )

@dp.message(Command("stats"))
async def stats_cmd(message: types.Message):
    """ููุงุด ุขูุงุฑ ู ุงุทูุงุนุงุช ูพุดุฑูุชู ุฑุจุงุช (ููุท ุจุฑุง ุงุฏูู)"""
    user_id = message.from_user.id
    
    # ุจุฑุฑุณ ุฏุณุชุฑุณ ุงุฏูู
    if user_id != ADMIN_ID:
        await message.answer("โ๏ธ ุดูุง ุฏุณุชุฑุณ ุจู ุงู ุจุฎุด ุฑุง ูุฏุงุฑุฏ.")
        return
    
    # ุฌูุนโุขูุฑ ุขูุงุฑ ฺฉุงุฑุจุฑุงู
    cursor.execute("SELECT COUNT(*) FROM users")
    total_users = cursor.fetchone()[0]
    
    cursor.execute("SELECT COUNT(*) FROM users WHERE partner_id IS NOT NULL")
    connected_users = cursor.fetchone()[0]
    
    # ุชุนุฏุงุฏ ูพุงูโูุง ุชุจุงุฏู ุดุฏู
    cursor.execute("SELECT COUNT(*) FROM messages")
    total_messages = cursor.fetchone()[0]
    
    # ุชุนุฏุงุฏ ุณูุงูุงุช ู ูพุงุณุฎโูุง
    cursor.execute("SELECT COUNT(*) FROM questions")
    total_questions = cursor.fetchone()[0]
    
    cursor.execute("SELECT COUNT(*) FROM questions WHERE answer IS NOT NULL")
    answered_questions = cursor.fetchone()[0]
    
    # ฺฉุงุฑุจุฑุงู ูุนุงู ุฏุฑ ฒด ุณุงุนุช ฺฏุฐุดุชู (ุจุฑุงุณุงุณ ูพุงู ุง ุณูุงู)
    yesterday_timestamp = int(time.time()) - (24 * 3600)
    cursor.execute("""
        SELECT COUNT(DISTINCT user_id) FROM (
            SELECT sender_id as user_id FROM messages WHERE id IN (
                SELECT MAX(id) FROM messages GROUP BY sender_id
            ) AND id IN (
                SELECT id FROM messages WHERE id > (
                    SELECT COALESCE(MAX(id), 0) FROM messages WHERE sender_id = ? 
                    AND id IN (SELECT MAX(id) FROM messages GROUP BY sender_id)
                ) - 100
            )
            UNION
            SELECT user_id FROM questions WHERE timestamp > ?
        )
    """, (ADMIN_ID, yesterday_timestamp))
    active_users_24h = cursor.fetchone()[0]
    
    # ููุงุด ุขูุงุฑ ุจู ุงุฏูู
    stats_message = (
        "๐ **ุขูุงุฑ ู ุงุทูุงุนุงุช ุฑุจุงุช**\n\n"
        f"๐ฅ **ฺฉุงุฑุจุฑุงู**:\n"
        f"๐ ฺฉู ฺฉุงุฑุจุฑุงู: {total_users}\n"
        f"๐ ฺฉุงุฑุจุฑุงู ูุชุตู ุดุฏู: {connected_users}\n"
        f"๐ ฺฉุงุฑุจุฑุงู ูุนุงู (ฒด ุณุงุนุช ุงุฎุฑ): {active_users_24h}\n\n"
        f"๐ฌ **ูพุงูโูุง ู ุณูุงูุงุช**:\n"
        f"๐จ ฺฉู ูพุงูโูุง ุงุฑุณุงู: {total_messages}\n"
        f"โ ฺฉู ุณูุงูุงุช: {total_questions}\n"
        f"โ ุณูุงูุงุช ูพุงุณุฎ ุฏุงุฏู ุดุฏู: {answered_questions}\n"
        f"โณ ุณูุงูุงุช ุจโูพุงุณุฎ: {total_questions - answered_questions}\n\n"
        f"๐ **ูุฑุฎโูุง**:\n"
        f"๐ ูุฑุฎ ุงุชุตุงู: {(connected_users / total_users * 100) if total_users > 0 else 0:.1f}%\n"
        f"๐ ูุฑุฎ ูพุงุณุฎฺฏู: {(answered_questions / total_questions * 100) if total_questions > 0 else 0:.1f}%"
    )
    
    # ุงุฌุงุฏ ฺฉุจูุฑุฏ ุจุฑุง ุนููุงุชโูุง ูุฏุฑุช
    admin_keyboard = InlineKeyboardMarkup(
        inline_keyboard=[
            [
                InlineKeyboardButton(text="๐ ุขูุงุฑ ุฌุฒุฆโุชุฑ", callback_data="detailed_stats"),
                InlineKeyboardButton(text="๐ฑ ฺฉุงุฑุจุฑุงู ูุนุงู", callback_data="active_users")
            ],
            [
                InlineKeyboardButton(text="โ๏ธ ูพุงฺฉุณุงุฒ ุบุฑูุนุงูโูุง", callback_data="purge_inactive"),
                InlineKeyboardButton(text="๐จ ูพุงู ฺฏุฑูู", callback_data="new_broadcast")
            ]
        ]
    )
    
    await message.answer(stats_message, reply_markup=admin_keyboard, parse_mode="Markdown")

@dp.callback_query(lambda c: c.data == "detailed_stats")
async def detailed_stats_callback(callback: types.CallbackQuery):
    """ููุงุด ุขูุงุฑ ุฌุฒุฆโุชุฑ ุฑุจุงุช"""
    user_id = callback.from_user.id
    
    # ุจุฑุฑุณ ุฏุณุชุฑุณ ุงุฏูู
    if user_id != ADMIN_ID:
        await callback.answer("โ๏ธ ุดูุง ุฏุณุชุฑุณ ุจู ุงู ุจุฎุด ุฑุง ูุฏุงุฑุฏ.", show_alert=True)
        return
    
    # ุขูุงุฑ ฺฉุงุฑุจุฑุงู ุฌุฏุฏ ุท ููุชู ุงุฎุฑ
    week_ago = int(time.time()) - (7 * 24 * 3600)
    cursor.execute("""
        SELECT COUNT(*) FROM users 
        WHERE user_id IN (
            SELECT MIN(user_id) FROM users 
            GROUP BY user_id
            HAVING MIN(rowid) IN (
                SELECT rowid FROM users 
                WHERE rowid > (SELECT MAX(rowid) FROM users) - 100
            )
        )
    """)
    new_users_week = cursor.fetchone()[0]
    
    # ุขูุงุฑ ูุนุงูุช ฺฉุงุฑุจุฑุงู
    cursor.execute("""
        SELECT 
            COUNT(CASE WHEN partner_id IS NOT NULL THEN 1 END) as connected,
            COUNT(CASE WHEN partner_id IS NULL THEN 1 END) as single
        FROM users
    """)
    connected, single = cursor.fetchone()
    
    # ูุงูฺฏู ุชุนุฏุงุฏ ูพุงูโูุง ุงุฑุณุงู ูุฑ ฺฉุงุฑุจุฑ
    cursor.execute("""
        SELECT AVG(msg_count) FROM (
            SELECT sender_id, COUNT(*) as msg_count FROM messages
            GROUP BY sender_id
        )
    """)
    avg_messages = cursor.fetchone()[0]
    
    # ุชุนุฏุงุฏ ฺุงูุดโูุง ูุนุงู
    cursor.execute("SELECT COUNT(*) FROM questions WHERE answer IS NULL")
    active_challenges = cursor.fetchone()[0]
    
    detailed_stats = (
        "๐ **ุขูุงุฑ ุชูุตู ุฑุจุงุช**\n\n"
        f"๐ค **ฺฉุงุฑุจุฑุงู**:\n"
        f"๐ ฺฉุงุฑุจุฑุงู ุฌุฏุฏ (ููุชู ุงุฎุฑ): {new_users_week}\n"
        f"๐ ูุณุจุช ฺฉุงุฑุจุฑุงู ูุชุตู ุจู ูุฌุฑุฏ: {connected}:{single}\n\n"
        f"๐ฌ **ูุนุงูุช**:\n"
        f"๐ ูุงูฺฏู ูพุงู ูุฑ ฺฉุงุฑุจุฑ: {avg_messages:.1f}\n"
        f"๐ฏ ฺุงูุดโูุง ูุนุงู: {active_challenges}\n\n"
        f"โฑ ุขูุงุฑ ุจูโุฑูุฒุฑุณุงู ุดุฏ: {time.strftime('%H:%M:%S')}"
    )
    
    # ุฏฺฉูู ุจุงุฒฺฏุดุช ุจู ููู ุงุตู ุขูุงุฑ
    back_button = InlineKeyboardMarkup(
        inline_keyboard=[
            [InlineKeyboardButton(text="๐ ุจุงุฒฺฏุดุช ุจู ููู ุขูุงุฑ", callback_data="back_to_stats")]
        ]
    )
    
    await callback.message.edit_text(detailed_stats, reply_markup=back_button, parse_mode="Markdown")
    await callback.answer()

@dp.callback_query(lambda c: c.data == "active_users")
async def active_users_callback(callback: types.CallbackQuery):
    """ููุงุด ูุณุช ฺฉุงุฑุจุฑุงู ูุนุงู ุงุฎุฑ"""
    user_id = callback.from_user.id
    
    # ุจุฑุฑุณ ุฏุณุชุฑุณ ุงุฏูู
    if user_id != ADMIN_ID:
        await callback.answer("โ๏ธ ุดูุง ุฏุณุชุฑุณ ุจู ุงู ุจุฎุด ุฑุง ูุฏุงุฑุฏ.", show_alert=True)
        return
    
    # ุฏุฑุงูุช ูุณุช ฺฉุงุฑุจุฑุงู ูุนุงู ุฏุฑ ููุชู ุงุฎุฑ
    week_ago = int(time.time()) - (7 * 24 * 3600)
    cursor.execute("""
        SELECT DISTINCT u.user_id, u.username, u.first_name, u.last_name 
        FROM users u
        JOIN messages m ON u.user_id = m.sender_id
        WHERE m.id IN (
            SELECT MAX(id) FROM messages
            WHERE sender_id = u.user_id
            GROUP BY sender_id
        )
        ORDER BY m.id DESC
        LIMIT 20
    """)
    
    active_users = cursor.fetchall()
    
    if not active_users:
        await callback.message.edit_text(
            "โ๏ธ ูฺ ฺฉุงุฑุจุฑ ูุนุงู ุงูุช ูุดุฏ.", 
            reply_markup=InlineKeyboardMarkup(
                inline_keyboard=[[InlineKeyboardButton(text="๐ ุจุงุฒฺฏุดุช", callback_data="back_to_stats")]]
            )
        )
        await callback.answer()
        return
    
    active_users_text = "๐ฅ **ฒฐ ฺฉุงุฑุจุฑ ูุนุงู ุงุฎุฑ**:\n\n"
    
    for i, (uid, username, fname, lname) in enumerate(active_users, 1):
        display_name = fname or username or "ุจุฏูู ูุงู"
        if lname:
            display_name += f" {lname}"
        active_users_text += f"{i}. [{display_name}](tg://user?id={uid})"
        if username:
            active_users_text += f" - @{username}"
        active_users_text += "\n"
    
    # ุฏฺฉูู ุจุงุฒฺฏุดุช
    back_button = InlineKeyboardMarkup(
        inline_keyboard=[
            [InlineKeyboardButton(text="๐ ุจุงุฒฺฏุดุช ุจู ููู ุขูุงุฑ", callback_data="back_to_stats")]
        ]
    )
    
    await callback.message.edit_text(active_users_text, reply_markup=back_button, parse_mode="Markdown")
    await callback.answer()

@dp.callback_query(lambda c: c.data == "back_to_stats")
async def back_to_stats_callback(callback: types.CallbackQuery):
    """ุจุงุฒฺฏุดุช ุจู ููู ุงุตู ุขูุงุฑ"""
    # ูุฑุงุฎูุงู ูุฌุฏุฏ ุชุงุจุน ุขูุงุฑ
    message = callback.message
    # ุงุฌุงุฏ ฺฉ ูพุงู ูุฌุงุฒ ุจุฑุง ูุฑุงุฎูุงู ุชุงุจุน stats_cmd
    mock_message = types.Message(
        message_id=message.message_id,
        date=message.date,
        chat=message.chat,
        from_user=callback.from_user,
        text="/stats",
        bot=bot,
        reply_to_message=None,
        sender_chat=None,
        forward_from=None,
        forward_from_chat=None,
        forward_from_message_id=None,
        forward_signature=None,
        forward_date=None,
        reply_to_message_id=None,
        media_group_id=None,
        author_signature=None,
        entities=None,
        caption=None,
        caption_entities=None,
        has_protected_content=None,
        edit_date=None,
        is_topic_message=None,
        message_thread_id=None,
        forum_topic_created=None,
        forum_topic_closed=None,
        forum_topic_reopened=None,
        forum_topic_edited=None,
        general_forum_topic_hidden=None,
        general_forum_topic_unhidden=None,
        via_bot=None,
        restrict_content=None,
        web_page_preview=None
    )
    await stats_cmd(mock_message)
    await callback.message.delete()
    await callback.answer()

@dp.callback_query(lambda c: c.data == "new_broadcast")
async def new_broadcast_callback(callback: types.CallbackQuery):
    """ุดุฑูุน ูุฑุงุญู ุงุฑุณุงู ูพุงู ฺฏุฑูู ุฌุฏุฏ"""
    user_id = callback.from_user.id
    
    # ุจุฑุฑุณ ุฏุณุชุฑุณ ุงุฏูู
    if user_id != ADMIN_ID:
        await callback.answer("โ๏ธ ุดูุง ุฏุณุชุฑุณ ุจู ุงู ุจุฎุด ุฑุง ูุฏุงุฑุฏ.", show_alert=True)
        return
    
    await callback.message.answer(
        "๐ฃ **ุงุฑุณุงู ูพุงู ฺฏุฑูู ุฌุฏุฏ**\n\n"
        "ูุทูุง ูุชู ูพุงู ฺฏุฑูู ุฎูุฏ ุฑุง ุจุง ูุฑูุช ุฒุฑ ุงุฑุณุงู ฺฉูุฏ:\n\n"
        "`/broadcast ูุชู ูพุงู ุดูุง ุฏุฑ ุงูุฌุง`\n\n"
        "โ๏ธ ุชูุฌู: ุงู ูพุงู ุจู ุชูุงู ฺฉุงุฑุจุฑุงู ุฑุจุงุช ุงุฑุณุงู ุฎูุงูุฏ ุดุฏ."
    )
    await callback.answer()

@dp.callback_query(lambda c: c.data == "purge_inactive")
async def purge_inactive_callback(callback: types.CallbackQuery):
    """ุญุฐู ฺฉุงุฑุจุฑุงู ุบุฑูุนุงู (ุจุด ุงุฒ 3 ูุงู)"""
    user_id = callback.from_user.id
    
    # ุจุฑุฑุณ ุฏุณุชุฑุณ ุงุฏูู
    if user_id != ADMIN_ID:
        await callback.answer("โ๏ธ ุดูุง ุฏุณุชุฑุณ ุจู ุงู ุจุฎุด ุฑุง ูุฏุงุฑุฏ.", show_alert=True)
        return
    
    # ฺฉุจูุฑุฏ ุชุงุฏ
    confirm_keyboard = InlineKeyboardMarkup(
        inline_keyboard=[
            [
                InlineKeyboardButton(text="โ ุจููุ ุญุฐู ุดููุฏ", callback_data="confirm_purge"),
                InlineKeyboardButton(text="โ ุฎุฑุ ูุบู ุนููุงุช", callback_data="cancel_purge")
            ]
        ]
    )
    
    three_months_ago = int(time.time()) - (90 * 24 * 3600)
    
    # ุดูุงุฑุด ฺฉุงุฑุจุฑุงู ุบุฑูุนุงู
    cursor.execute("""
        SELECT COUNT(*) FROM users 
        WHERE user_id NOT IN (
            SELECT DISTINCT sender_id FROM messages 
            WHERE sender_id IN (SELECT user_id FROM users)
            AND id > (SELECT MAX(id) FROM messages) - 1000
        )
        AND user_id != ?
    """, (ADMIN_ID,))
    
    inactive_count = cursor.fetchone()[0]
    
    await callback.message.edit_text(
        f"โ๏ธ **ุญุฐู ฺฉุงุฑุจุฑุงู ุบุฑูุนุงู**\n\n"
        f"ุชุนุฏุงุฏ {inactive_count} ฺฉุงุฑุจุฑ ุบุฑูุนุงู ุดูุงุณุง ุดุฏูุฏ.\n"
        f"ุขุง ูุทูุฆู ูุณุชุฏ ฺฉู ูโุฎูุงูุฏ ุงู ฺฉุงุฑุจุฑุงู ุฑุง ุญุฐู ฺฉูุฏุ",
        reply_markup=confirm_keyboard
    )
    await callback.answer()

@dp.callback_query(lambda c: c.data == "confirm_purge")
async def confirm_purge_callback(callback: types.CallbackQuery):
    """ุชุงุฏ ู ุงูุฌุงู ุนููุงุช ุญุฐู ฺฉุงุฑุจุฑุงู ุบุฑูุนุงู"""
    user_id = callback.from_user.id
    
    # ุจุฑุฑุณ ุฏุณุชุฑุณ ุงุฏูู
    if user_id != ADMIN_ID:
        await callback.answer("โ๏ธ ุดูุง ุฏุณุชุฑุณ ุจู ุงู ุจุฎุด ุฑุง ูุฏุงุฑุฏ.", show_alert=True)
        return
    
    three_months_ago = int(time.time()) - (90 * 24 * 3600)
    
    # ุดูุงุณุง ฺฉุงุฑุจุฑุงู ุบุฑูุนุงู
    cursor.execute("""
        SELECT user_id FROM users 
        WHERE user_id NOT IN (
            SELECT DISTINCT sender_id FROM messages 
            WHERE sender_id IN (SELECT user_id FROM users)
            AND id > (SELECT MAX(id) FROM messages) - 1000
        )
        AND user_id != ?
    """, (ADMIN_ID,))
    
    inactive_users = [user[0] for user in cursor.fetchall()]
    
    if not inactive_users:
        await callback.message.edit_text("โ ูฺ ฺฉุงุฑุจุฑ ุบุฑูุนุงู ุจุฑุง ุญุฐู ุงูุช ูุดุฏ.")
        await callback.answer()
        return
    
    # ุญุฐู ฺฉุงุฑุจุฑุงู ุบุฑูุนุงู
    for user_id in inactive_users:
        # ุงุจุชุฏุง ุญุฐู ูพุงูโูุง ู ุณูุงูุงุช ูุฑุชุจุท
        cursor.execute("DELETE FROM messages WHERE sender_id = ? OR receiver_id = ?", (user_id, user_id))
        cursor.execute("DELETE FROM questions WHERE user_id = ? OR partner_id = ?", (user_id, user_id))
        
        # ุณูพุณ ุญุฐู ุฎูุฏ ฺฉุงุฑุจุฑ
        cursor.execute("DELETE FROM users WHERE user_id = ?", (user_id,))
    
    conn.commit()
    
    await callback.message.edit_text(
        f"โ ุนููุงุช ุจุง ููููุช ุงูุฌุงู ุดุฏ.\n"
        f"ุชุนุฏุงุฏ {len(inactive_users)} ฺฉุงุฑุจุฑ ุบุฑูุนุงู ุญุฐู ุดุฏูุฏ."
    )
    await callback.answer("ุนููุงุช ุจุง ููููุช ุงูุฌุงู ุดุฏ", show_alert=True)

@dp.callback_query(lambda c: c.data == "cancel_purge")
async def cancel_purge_callback(callback: types.CallbackQuery):
    """ูุบู ุนููุงุช ุญุฐู ฺฉุงุฑุจุฑุงู ุบุฑูุนุงู"""
    user_id = callback.from_user.id
    
    # ุจุฑุฑุณ ุฏุณุชุฑุณ ุงุฏูู
    if user_id != ADMIN_ID:
        await callback.answer("โ๏ธ ุดูุง ุฏุณุชุฑุณ ุจู ุงู ุจุฎุด ุฑุง ูุฏุงุฑุฏ.", show_alert=True)
        return
    
    await callback.message.edit_text("โ ุนููุงุช ุญุฐู ฺฉุงุฑุจุฑุงู ุบุฑูุนุงู ูุบู ุดุฏ.")
    await callback.answer()

@dp.message(lambda message: message.text == "โ๏ธ ูพูู ูุฏุฑุช")
async def admin_panel_btn(message: types.Message):
    """ูพุงุณุฎ ุจู ุฏฺฉูู ูพูู ูุฏุฑุช"""
    user_id = message.from_user.id
    
    # ุจุฑุฑุณ ุฏุณุชุฑุณ ุงุฏูู
    if user_id != ADMIN_ID:
        await message.answer("โ๏ธ ุดูุง ุฏุณุชุฑุณ ุจู ุงู ุจุฎุด ุฑุง ูุฏุงุฑุฏ.")
        return
    
    # ุงุฌุงุฏ ฺฉุจูุฑุฏ ุงููุงู ุจุฑุง ุฏุณุชูุฑุงุช ูุฏุฑุช
    admin_keyboard = InlineKeyboardMarkup(
        inline_keyboard=[
            [InlineKeyboardButton(text="๐ ุขูุงุฑ ุฑุจุงุช", callback_data="show_stats")],
            [InlineKeyboardButton(text="๐ข ุงุฑุณุงู ูพุงู ฺฏุฑูู", callback_data="new_broadcast")],
            [InlineKeyboardButton(text="๐ ูพุงฺฉุณุงุฒ ฺฉุงุฑุจุฑุงู ุบุฑูุนุงู", callback_data="purge_inactive")],
        ]
    )
    
    await message.answer(
        "โ๏ธ **ูพูู ูุฏุฑุช ุฑุจุงุช**\n\n"
        "ุงุฒ ุทุฑู ุงู ุจุฎุด ูโุชูุงูุฏ ุนููุงุช ูุฏุฑุช ุฑุจุงุช ุฑุง ุงูุฌุงู ุฏูุฏ:",
        reply_markup=admin_keyboard,
        parse_mode="Markdown"
    )

@dp.callback_query(lambda c: c.data == "show_stats")
async def show_stats_callback(callback: types.CallbackQuery):
    """ููุงุด ุขูุงุฑ ุฑุจุงุช"""
    try:
        user_id = callback.from_user.id
        
        # ุจุฑุฑุณ ุฏุณุชุฑุณ ุงุฏูู
        if user_id != ADMIN_ID:
            await callback.answer("โ๏ธ ุดูุง ุฏุณุชุฑุณ ุจู ุงู ุจุฎุด ุฑุง ูุฏุงุฑุฏ.", show_alert=True)
            return
        
        # ุฌูุนโุขูุฑ ุขูุงุฑ ฺฉุงุฑุจุฑุงู ุจู ุตูุฑุช ูุณุชูู
        cursor.execute("SELECT COUNT(*) FROM users")
        total_users = cursor.fetchone()[0]
        
        cursor.execute("SELECT COUNT(*) FROM users WHERE partner_id IS NOT NULL")
        connected_users = cursor.fetchone()[0]
        
        # ุชุนุฏุงุฏ ูพุงูโูุง ุชุจุงุฏู ุดุฏู
        cursor.execute("SELECT COUNT(*) FROM messages")
        total_messages = cursor.fetchone()[0]
        
        # ุชุนุฏุงุฏ ุณูุงูุงุช ู ูพุงุณุฎโูุง
        cursor.execute("SELECT COUNT(*) FROM questions")
        total_questions = cursor.fetchone()[0]
        
        cursor.execute("SELECT COUNT(*) FROM questions WHERE answer IS NOT NULL")
        answered_questions = cursor.fetchone()[0]
        
        # ฺฉุงุฑุจุฑุงู ูุนุงู ุฏุฑ ฒด ุณุงุนุช ฺฏุฐุดุชู (ุจุฑุงุณุงุณ ูพุงู ุง ุณูุงู)
        yesterday_timestamp = int(time.time()) - (24 * 3600)
        cursor.execute("""
            SELECT COUNT(DISTINCT user_id) FROM (
                SELECT sender_id as user_id FROM messages WHERE id IN (
                    SELECT MAX(id) FROM messages GROUP BY sender_id
                ) AND id IN (
                    SELECT id FROM messages WHERE id > (
                        SELECT COALESCE(MAX(id), 0) FROM messages WHERE sender_id = ? 
                        AND id IN (SELECT MAX(id) FROM messages GROUP BY sender_id)
                    ) - 100
                )
                UNION
                SELECT user_id FROM questions WHERE timestamp > ?
            )
        """, (ADMIN_ID, yesterday_timestamp))
        active_users_24h = cursor.fetchone()[0]
        
        # ููุงุด ุขูุงุฑ ุจู ุงุฏูู
        stats_message = (
            "๐ **ุขูุงุฑ ู ุงุทูุงุนุงุช ุฑุจุงุช**\n\n"
            f"๐ฅ **ฺฉุงุฑุจุฑุงู**:\n"
            f"๐ ฺฉู ฺฉุงุฑุจุฑุงู: {total_users}\n"
            f"๐ ฺฉุงุฑุจุฑุงู ูุชุตู ุดุฏู: {connected_users}\n"
            f"๐ ฺฉุงุฑุจุฑุงู ูุนุงู (ฒด ุณุงุนุช ุงุฎุฑ): {active_users_24h}\n\n"
            f"๐ฌ **ูพุงูโูุง ู ุณูุงูุงุช**:\n"
            f"๐จ ฺฉู ูพุงูโูุง ุงุฑุณุงู: {total_messages}\n"
            f"โ ฺฉู ุณูุงูุงุช: {total_questions}\n"
            f"โ ุณูุงูุงุช ูพุงุณุฎ ุฏุงุฏู ุดุฏู: {answered_questions}\n"
            f"โณ ุณูุงูุงุช ุจโูพุงุณุฎ: {total_questions - answered_questions}\n\n"
            f"๐ **ูุฑุฎโูุง**:\n"
            f"๐ ูุฑุฎ ุงุชุตุงู: {(connected_users / total_users * 100) if total_users > 0 else 0:.1f}%\n"
            f"๐ ูุฑุฎ ูพุงุณุฎฺฏู: {(answered_questions / total_questions * 100) if total_questions > 0 else 0:.1f}%"
        )
        
        # ุงุฌุงุฏ ฺฉุจูุฑุฏ ุจุฑุง ุนููุงุชโูุง ูุฏุฑุช
        admin_keyboard = InlineKeyboardMarkup(
            inline_keyboard=[
                [
                    InlineKeyboardButton(text="๐ ุขูุงุฑ ุฌุฒุฆโุชุฑ", callback_data="detailed_stats"),
                    InlineKeyboardButton(text="๐ฑ ฺฉุงุฑุจุฑุงู ูุนุงู", callback_data="active_users")
                ],
                [
                    InlineKeyboardButton(text="โ๏ธ ูพุงฺฉุณุงุฒ ุบุฑูุนุงูโูุง", callback_data="purge_inactive"),
                    InlineKeyboardButton(text="๐จ ูพุงู ฺฏุฑูู", callback_data="new_broadcast")
                ]
            ]
        )
        
        # ุณุน ฺฉู ุงุฒ ุงุฑุณุงู ูพุงู ุฌุฏุฏ ุจู ุฌุง ูุฑุงุด ุงุณุชูุงุฏู ฺฉู
        try:
            # ุงุจุชุฏุง ุณุน ูโฺฉูู ูพุงู ุฑุง ูุฑุงุด ฺฉูู
            await callback.message.edit_text(stats_message, reply_markup=admin_keyboard, parse_mode="Markdown")
        except Exception as edit_error:
            logging.error(f"ุฎุทุง ุฏุฑ ูุฑุงุด ูพุงู ุขูุงุฑ: {edit_error}")
            # ุงฺฏุฑ ูุฑุงุด ุจุง ุฎุทุง ููุงุฌู ุดุฏุ ูพุงู ุฑุง ุญุฐู ฺฉุฑุฏู ู ฺฉ ูพุงู ุฌุฏุฏ ุงุฑุณุงู ูโฺฉูู
            await callback.message.delete()
            await callback.message.answer(stats_message, reply_markup=admin_keyboard, parse_mode="Markdown")
        
        await callback.answer("ุขูุงุฑ ุจูโุฑูุฒุฑุณุงู ุดุฏ")
    except Exception as e:
        logging.error(f"ุฎุทุง ุฏุฑ ููุงุด ุขูุงุฑ: {e}")
        await callback.answer(f"ุฎุทุง ุฑุฎ ุฏุงุฏ: {str(e)}", show_alert=True)
        try:
            # ุงุฑุณุงู ูพุงู ุณุงุฏู ุฏุฑ ุตูุฑุช ุฎุทุง
            await callback.message.answer(f"โ๏ธ ุฎุทุง ุฏุฑ ุฏุฑุงูุช ุขูุงุฑ ุฑุฎ ุฏุงุฏ: {str(e)}")
        except Exception:
            # ุงฺฏุฑ ุงุฑุณุงู ูพุงู ูู ููููุชโุขูุฒ ูุจูุฏุ ูุงุฏุฏู ุจฺฏุฑ
            pass

@dp.message(lambda message: message.text == "โญ๏ธ ุฏุฑุงูุช ฺุงูุด ุฌุฏุฏ")
async def challenge_button(message: types.Message):
    """ุฏฺฉูู ุฏุฑุงูุช ฺุงูุด ุฌุฏุฏ"""
    # ุงุณุชูุงุฏู ุงุฒ ุชุงุจุน ูุจู ุจุฑุง ุงุฑุณุงู ฺุงูุด
    await new_challenge_cmd(message)

@dp.message(lambda message: message.text == "๐ ูุถุนุช ูู")
async def status_button(message: types.Message):
    """ุฏฺฉูู ููุงุด ูุถุนุช ฺฉุงุฑุจุฑ"""
    # ุงุณุชูุงุฏู ุงุฒ ุชุงุจุน ูุจู ุจุฑุง ููุงุด ูุถุนุช
    await show_status_cmd(message)

@dp.message(lambda message: message.text == "๐ฅ ูพุงุฑุชูุฑ ูู")
async def partner_button(message: types.Message):
    """ุฏฺฉูู ูุฏุฑุช ูพุงุฑุชูุฑ"""
    # ุงุณุชูุงุฏู ุงุฒ ุชุงุจุน ูุจู ุจุฑุง ูุฏุฑุช ูพุงุฑุชูุฑ
    await manage_partner_cmd(message)

@dp.message(lambda message: message.text == "๐จ ูพุงู ุจู ูพุงุฑุชูุฑ")
async def message_button(message: types.Message):
    """ุฏฺฉูู ุงุฑุณุงู ูพุงู ุจู ูพุงุฑุชูุฑ"""
    user_id = message.from_user.id
    
    # ุจุฑุฑุณ ุนุถูุช ฺฉุงุฑุจุฑ ุฏุฑ ฺฉุงูุงู
    is_subscribed = await check_subscription(user_id)
    if not is_subscribed:
        subscription_keyboard = get_subscription_keyboard()
        await message.answer(
            f"โ๏ธ ุจุฑุง ุงุณุชูุงุฏู ุงุฒ ุฑุจุงุชุ ุงุจุชุฏุง ุจุงุฏ ุฏุฑ ฺฉุงูุงู {CHANNEL_TITLE} ุนุถู ุดูุฏ.",
            reply_markup=subscription_keyboard
        )
        return
    
    # ุจุฑุฑุณ ูุฌูุฏ ูพุงุฑุชูุฑ
    cursor.execute("SELECT partner_id FROM users WHERE user_id=?", (user_id,))
    user_data = cursor.fetchone()
    
    if not user_data or not user_data[0]:
        # ูพุงุฑุชูุฑ ูุฌูุฏ ูุฏุงุฑุฏ
        keyboard = InlineKeyboardMarkup(
            inline_keyboard=[
                [InlineKeyboardButton(text="๐ ุงุชุตุงู ุจู ูพุงุฑุชูุฑ", callback_data="start_connect")]
            ]
        )
        await message.answer("โ๏ธ ุดูุง ูููุฒ ุจู ูพุงุฑุชูุฑ ูุชุตู ูุณุชุฏ. ุงุจุชุฏุง ุจุงุฏ ุจุง ฺฉุณ ุงุฑุชุจุงุท ุจุฑูุฑุงุฑ ฺฉูุฏ.", reply_markup=keyboard)
        return
    
    partner_id = user_data[0]
    
    # ุงุทูุงุนุงุช ูพุงุฑุชูุฑ
    try:
        partner_info = await bot.get_chat(partner_id)
        partner_name = partner_info.first_name or "ูพุงุฑุชูุฑ"
    except:
        partner_name = "ูพุงุฑุชูุฑ"
    
    # ุงุฑุณุงู ุฑุงูููุง ุงุฑุณุงู ูพุงู
    await message.answer(
        f"๐ฌ *ุงุฑุณุงู ูพุงู ุจู {partner_name}*\n\n"
        "ูพุงู ุฎูุฏ ุฑุง ุจููุณุฏ ุง ุฑุณุงููโุง ุงุฑุณุงู ฺฉูุฏ. ูพุงู ุดูุง ูุณุชููุงู ุจุฑุง ูพุงุฑุชูุฑ ุดูุง ุงุฑุณุงู ุฎูุงูุฏ ุดุฏ.\n\n"
        "๐ก ุดูุง ูโุชูุงูุฏ ูุชูุ ุนฺฉุณุ ูุฏูุ ุตุฏุงุ ุงุณุชฺฉุฑ ู... ุงุฑุณุงู ฺฉูุฏ.",
        parse_mode="Markdown"
    )

@dp.message(lambda message: message.text == "๐ ูพุดุชุจุงู")
async def support_button(message: types.Message):
    """ุฏฺฉูู ูพุดุชุจุงู"""
    # ุงุณุชูุงุฏู ุงุฒ ุชุงุจุน ูุจู ุจุฑุง ูพุดุชุจุงู
    await support_cmd(message)

if __name__ == "__main__":
    asyncio.run(main()) 
